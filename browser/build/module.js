var Mt=Object.defineProperty;var fn=(e,n)=>{for(var t in n)Mt(e,t,{get:n[t],enumerable:!0,configurable:!0,set:(i)=>n[t]=()=>i})};var Lt=globalThis.fetch,hn=Lt;console.error("wwws does not support the browser.");var ln=null;var ge={},Wt=typeof window<"u"&&typeof HTMLElement<"u",Kt=typeof WebSocketPair<"u"&&typeof Cloudflare<"u",_t=typeof process<"u"&&process.moduleLoadList?.length>0,qt=typeof Deno<"u",Ct=typeof Bun<"u";if(!Wt&&!Kt&&!_t&&!qt&&!Ct)throw Error("yolkbot doesn't know how to run in this environment. Please open an issue on GitHub with information on where you run yolkbot.");ge.fetch=typeof process>"u"?globalThis.fetch:hn;ge.WebSocket=typeof process>"u"?globalThis.WebSocket:ln;var L=ge;var gn={};fn(gn,{findItemById:()=>w,UserAgent:()=>ne,Team:()=>Jt,StateBufferSize:()=>ee,SocialReward:()=>Yt,SocialMedia:()=>Ne,ShellStreak:()=>x,PlayType:()=>pe,Movement:()=>O,ItemType:()=>W,GunList:()=>H,GunEquipTime:()=>Oe,GameOptionFlag:()=>Re,GameMode:()=>T,GameAction:()=>z,FramesBetweenSyncs:()=>C,FirebaseKey:()=>B,CoopState:()=>b,CollectType:()=>oe,ChiknWinnerDailyLimit:()=>Te,ChatFlag:()=>Ht,ChallengeType:()=>Bt,ChallengeSubType:()=>Zt,BanDuration:()=>ve});var kn={};fn(kn,{SMG:()=>xe,RPEGG:()=>we,M24:()=>Se,EggK47:()=>Pe,DozenGauge:()=>de,Cluck9mm:()=>ye,CSG1:()=>Ie,AUG:()=>Ue});var Pe={ammo:{capacity:30,reload:30,store:240,pickup:30},longReloadTime:205,shortReloadTime:160,weaponName:"EggK-47",internalName:"Eggk47",damage:30,range:20,rof:3,totalDamage:30,velocity:1.5},de={ammo:{capacity:2,reload:2,store:24,pickup:8},longReloadTime:155,shortReloadTime:155,weaponName:"Scrambler",internalName:"Dozen Gauge",damage:8.5,range:8,rof:8,totalDamage:170,velocity:1},Ie={ammo:{capacity:15,reload:15,store:60,pickup:15},longReloadTime:225,shortReloadTime:165,weaponName:"Free Ranger",internalName:"CSG-1",damage:105,range:50,rof:13,totalDamage:105,velocity:1.75},ye={ammo:{capacity:15,reload:15,store:60,pickup:15},longReloadTime:195,shortReloadTime:160,weaponName:"Cluck 9mm",internalName:"Cluck 9mm",damage:26,range:15,rof:4,totalDamage:26,velocity:1},we={ammo:{capacity:1,reload:1,store:3,pickup:1},longReloadTime:170,shortReloadTime:170,weaponName:"RPEGG",internalName:"Eggsploder",damage:140,range:45,rof:40,totalDamage:192.5,velocity:0.4},xe={ammo:{capacity:40,reload:40,store:200,pickup:40},longReloadTime:225,shortReloadTime:190,weaponName:"Whipper",internalName:"SMEGG",damage:23,range:20,rof:2,totalDamage:23,velocity:1.25},Se={ammo:{capacity:1,reload:1,store:12,pickup:4},longReloadTime:144,shortReloadTime:144,weaponName:"Crackshot",internalName:"M2DZ",damage:170,range:60,rof:15,totalDamage:170,velocity:2},Ue={ammo:{capacity:24,reload:24,store:150,pickup:24},longReloadTime:205,shortReloadTime:160,weaponName:"Tri-Hard",internalName:"AUG",damage:32,range:20,rof:15,totalDamage:34,velocity:1.5};var w=()=>null;var ve={FiveMinutes:0,FifteenMinutes:1,OneHour:2},Zt={Killstreak:0,KillWithWeapon:1,MovementDistance:3,Jumping:4,TimePlayed:6,TimeAlive:7,KillWithCondition:8,TotalKills:10,SpatulaKills:10,Collecting:18,FromTheCoop:20,SpecialOffensive:21,WinKOTC:23,KillWithSpatula:23},Bt={Kill:0,Damage:1,Death:2,Movement:3,Collect:4,Time:5,KOTC:6,Spatula:7},Ht={None:0,Pinned:2,Team:4,Mod:254,Server:255},Te=3,oe={Ammo:0,Grenade:1},b={Start:0,Score:1,Win:2,Capturing:3,Contested:4,Takeover:5,Abandoned:6,Unclaimed:7},B="AIzaSyDP4SIjKaw6A4c-zvfYxICpbEjn1rRnN50",C=3,z={Reset:1,Pause:2},T={FFA:0,Team:1,Spatula:2,KOTC:3},Re={Locked:1,NoTeamChange:2,NoTeamShuffle:4},Oe=13,H=[Pe,de,Ie,we,xe,Se,Ue],W={Hat:1,Stamp:2,Primary:3,Secondary:4,Grenade:6,Melee:7},O={Forward:1,Backward:2,Left:4,Right:8,Jump:16,Fire:32,Melee:64,Scope:128},pe={JoinPublic:0,CreatePrivate:1,JoinPrivate:2},x={HardBoiled:1,EggBreaker:2,Restock:4,OverHeal:8,DoubleEggs:16,MiniEgg:32},Ne={Facebook:0,Instagram:1,Tiktok:2,Discord:3,Youtube:4,Twitter:5,Twitch:6},Yt={Discord:"rew_1200",Tiktok:"rew_1208",Instagram:"rew_1219",Steam:"rew_1223",Facebook:"rew_1227",Twitter:"rew_1234",Twitch:"rew_twitch_social"},ee=256,Jt={Blue:1,Red:2},ne="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36";class Pn{connected=!1;autoReconnect=!1;url="";proxy="";binaryType="";maxRetries=5;connectionTimeout=5000;onopen=()=>{};onmessage=()=>{};onclose=()=>{};onerror=()=>{};constructor(e,n){if(typeof process>"u"&&n)throw Error("You cannot pass a proxy to a WebSocket in this environment.");this.url=e,this.proxy=n}async tryConnect(e=1){let n=new URL(this.url),t=async()=>{if(e===5)return!1;return await this.tryConnect(e+1)};try{if(this.socket=typeof process>"u"?new L.WebSocket(this.url):new L.WebSocket(this.url,{proxy:this.proxy||null,headers:{"accept-encoding":"gzip, deflate, br, zstd","accept-language":"en-US,en;q=0.9","cache-control":"no-cache",connection:"Upgrade",origin:n.origin.replace("ws","http"),pragma:"no-cache","user-agent":ne}}),this.binaryType)this.socket.binaryType=this.binaryType}catch(i){return console.error(`Failed to connect on try ${e}, trying again...`,i),await t()}if(this.onBeforeConnect)this.onBeforeConnect();return new Promise((i)=>{let r=setTimeout(async()=>{this.socket.close(),i(await t())},this.connectionTimeout),s=async(c)=>{clearTimeout(r),console.error("WebSocket error",c),i(await t())};this.socket.addEventListener("open",async()=>{clearTimeout(r),this.connected=!0,this.socket.removeEventListener("error",s),this.socket.addEventListener("open",(...c)=>this.onopen(...c)),this.socket.addEventListener("message",(...c)=>this.onmessage(...c)),this.socket.addEventListener("close",(...c)=>this.onclose(...c)),this.socket.addEventListener("error",(...c)=>this.onerror(...c)),i(!0)}),this.socket.addEventListener("error",s),this.socket.addEventListener("close",()=>{if(this.connected){if(this.connected=!1,this.autoReconnect)setTimeout(async()=>{if(!await this.tryConnect()){if(this.onclose)this.onclose();console.error("tryConnect: failed to reconnect to",this.url,"after 5 attempts."),console.error("tryConnect: please check your internet connection & ensure your IP isn't blocked.")}},250)}})})}send(e){return this.socket?.send(e)}close(e){return this.autoReconnect=!1,this.socket?.close(e)}}var te=Pn;var N={WebSocketConnectFail:"websocket_connect_fail",MissingParams:"missing_params",NetworkFail:"firebase_network_failed",ServicesClosedEarly:"services_closed_early",InternalError:"unknown_error"},Fe={...N,AccountBanned:"account_banned"},Ee={SessionExpired:"PLAYER_NOT_FOUND",ItemNotFound:"ITEM_NOT_FOUND",ItemAlreadyOwned:"ALREADY_OWNED",CannotAfford:"INSUFFICIENT_FUNDS",InternalError:"UNKNOWN_ERROR"},K={OnCooldown:"on_cooldown",HitDailyLimit:"hit_daily_limit",NotAtDailyLimit:"not_at_limit",NotEnoughResetEggs:"not_enough_eggs",SessionExpired:"session_expired",InternalError:"unknown_error"},A={MissingParams:"missing_params",InvalidRegion:"region_not_in_list",InvalidMode:"mode_not_in_list",InvalidMap:"map_not_in_list",GameNotFound:"game_not_found",SessionExpired:"session_expired",InternalError:"unknown_error"},D={MissingParams:"missing_params",InvalidObject:"invalid_game_object",WebSocketConnectFail:"websocket_connect_fail",GameNotFound:"game_not_found",InternalError:"unknown_error"},dn={WebSocketConnectFail:"websocket_connect_fail"},l={CHALLENGES:1,BOT_STATS:2,PATHFINDING:3,PING:5,COSMETIC_DATA:6,PLAYER_HEALTH:7,PACKET_HOOK:8,LOG_PACKETS:10,SKIP_LOGIN:11,DEBUG_BUFFER:12,NO_AFK_KICK:16,LOAD_MAP:17,OBSERVE_GAME:18,RENEW_SESSION:21,VIP_HIDE_BADGE:22,SIMULATION:23},Ae={SessionExpired:"PLAYER_NOT_FOUND",CurrentlyRedeemingElsewhere:"CODE_DOUBLE_DOUBLE",AlreadyRedeemed:"CODE_PREV_REDEEMED",InvalidCode:"CODE_NOT_FOUND",Ratelimited:"RATE_LIMIT_REACHED",InternalError:"UNKNOWN_ERROR"},Ge={SessionExpired:"reward_expired_session",InvalidReward:"REWARD_NOT_FOUND",AlreadyRedeemed:"REWARD_PREV_GIVEN",InternalError:"unknown_error"},$e={SessionExpired:"urlRewardParams_expired_session",InvalidReward:"REWARD_NOT_FOUND",AlreadyRedeemed:"REWARD_PREV_GIVEN",InternalError:"unknown_error"},Me={SessionExpired:"challengeRerollSlot_expired_session",ChallengeNotFound:"challenge_not_found",ChallengeNotAssigned:"challenge_reroll_not_found",InternalError:"unknown_error"},Le={SessionExpired:"challengeClaimReward_expired_session",ChallengeNotFound:"challenge_claim_not_found",ChallengeNotCompleted:"challenge_not_completed",InternalError:"unknown_error"},$={NoPathFound:"no_path_found",PathTooShort:"path_too_short"},q={Despawned:"despawned",Killed:"killed",WalkedOut:"exited",RoundEnded:"round_ended"};var Y=(e)=>{let n=structuredClone(e);return n.ammo.rounds=n.ammo.capacity,n.ammo.storeMax=n.ammo.store,n},k=(e)=>({ok:!1,error:e}),In=async(e,n)=>{if(typeof process<"u"){let{existsSync:i,mkdirSync:r,readFileSync:s,writeFileSync:c}=process.getBuiltinModule("node:fs"),{join:o}=process.getBuiltinModule("node:path"),{homedir:p}=process.getBuiltinModule("node:os"),m=o(p(),".yolkbot");if(!i(m))r(m);let f=o(m,"maps");if(!i(f))r(f);let g=o(f,`${e}-${n}.json`);if(i(g))return JSON.parse(s(g,"utf-8"));let h=await(await fetch(`https://x.yolkbot.xyz/data/maps/full/${e}.json?${n}`)).json();return c(g,JSON.stringify(h,null,4),{flag:"w+"}),h}return await(await fetch(`https://x.yolkbot.xyz/data/maps/full/${e}.json?${n}`)).json()},yn=(e)=>{let n=e.length;if(!n)return[];let t=1/0,i=1/0,r=1/0,s=-1/0,c=-1/0,o=-1/0;for(let P=0;P<n;P++){let{x:R,y:F,z:_}=e[P];if(R<t)t=R;if(R>s)s=R;if(F<i)i=F;if(F>c)c=F;if(_<r)r=_;if(_>o)o=_}let p=s-t+1|0,m=c-i+1|0,f=o-r+1|0,g=p,h=p*m,I=new Int32Array(p*m*f).fill(-1),S=new Uint16Array(n),U=new Uint32Array(n);for(let P=0;P<n;P++){let{x:R,y:F,z:_}=e[P];I[(R-t|0)+(F-i|0)*g+(_-r|0)*h]=P}let y=[],v=0,E=[-1,g,-g,h,-h];E[0]=-1,E[1]=1,E[2]=-h,E[3]=h;for(let P=0;P<n;P++){if(S[P])continue;let R=++v,F=[],_=0,J=0;U[J++]=P,S[P]=R;while(_<J){let Gt=U[_++],he=e[Gt];he.zone=R,F[F.length]=he;let{x:le,y:$t,z:ke}=he,ce=(le-t|0)+($t-i|0)*g+(ke-r|0)*h,G;if(le>t&&(G=I[ce-1])!==-1&&!S[G])S[G]=R,U[J++]=G;if(le<s&&(G=I[ce+1])!==-1&&!S[G])S[G]=R,U[J++]=G;if(ke>r&&(G=I[ce-h])!==-1&&!S[G])S[G]=R,U[J++]=G;if(ke<o&&(G=I[ce+h])!==-1&&!S[G])S[G]=R,U[J++]=G}y[y.length]=F}return y};var ie={origin:"https://shellshock.io","user-agent":typeof process>"u"?null:ne,"x-client-version":"Chrome/JsCore/9.17.2/FirebaseCore-web","x-firebase-locale":"en"};class We{constructor(e={}){this.proxy=e.proxy,this.instance=e.instance||"shellshock.io",this.protocol=e.protocol||"wss",this.connectionTimeout=e.connectionTimeout||5000}queryServices=async(e)=>{let n=new te(`${this.protocol}://${this.instance}/services/`,this.proxy);if(n.connectionTimeout=this.connectionTimeout,!await n.tryConnect()||n.socket.readyState!==1)return k(N.WebSocketConnectFail);return new Promise((i)=>{let r=!1;n.onmessage=(s)=>{r=!0;try{let c=JSON.parse(s.data);i({ok:!0,...c})}catch(c){console.error("queryServices: error! command:",e.cmd,"and data:",e,c),i(k(N.InternalError))}n.close()},n.onerror=()=>!r&&i(k(N.InternalError)),n.onclose=()=>{if(r)return;console.log("queryServices: services closed before sending back message"),console.log("queryServices: command:",e.cmd,"and data:",e),i(k(N.ServicesClosedEarly))},n.send(JSON.stringify(e))})};#e=async(e,n,t)=>{if(!e||!n)return k(N.MissingParams);let i;try{i=await(await L.fetch(`https://identitytoolkit.googleapis.com/v1/accounts:${t}?key=${B}`,{method:"POST",body:JSON.stringify({email:e,password:n,returnSecureToken:!0}),headers:{...ie,"content-type":"application/json"},proxy:this.proxy})).json()}catch(s){if(s.code==="auth/network-request-failed")return console.error("authWithEmailPass: network error",i||s),k(N.NetworkFail);else if(s.code==="ERR_BAD_REQUEST")return console.error("authWithEmailPass: bad request",i||s),k(N.InternalError);return console.error("authWithEmailPass: unknown error:",e,n,s),k(N.InternalError)}if(!i.idToken)return console.error("authWithEmailPass: missing idToken",i),k(N.InternalError);this.idToken=i.idToken;let r=await this.queryServices({cmd:"auth",firebaseToken:i.idToken});return r.ok?{firebase:i,...r}:r};createAccount=(e,n)=>this.#e(e,n,"signUp");loginWithCredentials=(e,n)=>this.#e(e,n,"signInWithPassword");loginWithRefreshToken=async(e)=>{if(!e)return k(N.MissingParams);let n=new URLSearchParams;n.append("grant_type","refresh_token"),n.append("refresh_token",e);let t;try{t=await(await L.fetch(`https://securetoken.googleapis.com/v1/token?key=${B}`,{method:"POST",body:n.toString(),headers:{...ie,"content-type":"application/x-www-form-urlencoded"},proxy:this.proxy})).json()}catch(r){if(r.code==="auth/network-request-failed")return console.error("loginWithRefreshToken: network error",t||r),k(N.NetworkFail);return console.error("loginWithRefreshToken: unknown error:",t,r),k(N.InternalError)}if(!t.id_token)return console.error("loginWithRefreshToken: missing idToken",t),k(N.InternalError);this.idToken=t.id_token;let i=await this.queryServices({cmd:"auth",firebaseToken:t.id_token});return i.ok?{firebase:t,...i}:i};loginAnonymously=async()=>{let n=await(await L.fetch(`https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=${B}`,{method:"POST",body:JSON.stringify({returnSecureToken:!0}),headers:{...ie,"content-type":"application/json"},proxy:this.proxy})).json();if(!n.idToken)return console.error("loginAnonymously: missing idToken",n),k(N.InternalError);this.idToken=n.idToken;let t=await this.queryServices({cmd:"auth",firebaseToken:n.idToken});return t.ok?{firebase:n,...t}:t};sendEmailVerification=async(e=this.idToken)=>{if(!e)return k(N.MissingParams);let t=await(await L.fetch(`https://identitytoolkit.googleapis.com/v1/accounts:sendOobCode?key=${B}`,{method:"POST",body:JSON.stringify({requestType:"VERIFY_EMAIL",idToken:e}),headers:{...ie,"content-type":"application/json"},proxy:this.proxy})).json();if(t.kind!=="identitytoolkit#GetOobConfirmationCodeResponse")return console.error("sendEmailVerification: the game sent an invalid response",t),k(N.InternalError);return{ok:!0,email:t.email}};verifyOobCode=async(e)=>{if(!e)return k(N.MissingParams);let t=await(await L.fetch(`https://www.googleapis.com/identitytoolkit/v3/relyingparty/setAccountInfo?key=${B}`,{method:"POST",body:JSON.stringify({oobCode:e}),headers:{...ie,"x-client-version":"Chrome/JsCore/3.7.5/FirebaseCore-web",referer:"https://shellshockio-181719.firebaseapp.com/","content-type":"application/json"},proxy:this.proxy})).json();if(!t.emailVerified)return console.error("verifyOobCode: the game sent an invalid response",t),k(N.InternalError);return{ok:!0,email:t.email}}}var wn=We;class ue{static buffer;static idx;static init(e){this.buffer=new Uint8Array(e),this.idx=0}static isMoreDataAvailable(){return this.buffer.length-this.idx}static unPackInt8U(){return this.buffer[this.idx++]}static unPackInt8(){return this.unPackInt8U()<<24>>24}static unPackInt16U(){let e=this.idx;return this.idx+=2,this.buffer[e]|this.buffer[e+1]<<8}static unPackInt24U(){let e=this.idx;return this.idx+=3,this.buffer[e]|this.buffer[e+1]<<8|this.buffer[e+2]<<16}static unPackInt32U(){let e=this.idx;return this.idx+=4,(this.buffer[e]|this.buffer[e+1]<<8|this.buffer[e+2]<<16|this.buffer[e+3]<<24)>>>0}static unPackInt16(){return this.unPackInt16U()<<16>>16}static unPackInt32(){return this.unPackInt32U()<<0}static unPackRadU(){return this.unPackInt24U()/2097152}static unPackRad(){return this.unPackInt16U()/8192-Math.PI}static unPackFloat(){return this.unPackInt16()/256}static unPackDouble(){return this.unPackInt32()/1048576}static unPackString(e){e=e||255;let n=Math.min(this.unPackInt8U(),e);return this.unPackStringHelper(n)}static unPackLongString(e){e=e||16383;let n=Math.min(this.unPackInt16U(),e);return this.unPackStringHelper(n)}static unPackStringHelper(e){if(this.isMoreDataAvailable()<e*2)return"";let n=[];for(let t=0;t<e;t++){let i=this.unPackInt16U();if(i>0)n.push(String.fromCodePoint(i))}return n.join("")}}var a=ue;class me{constructor(e=16384){this.idx=0,this.arrayBuffer=new ArrayBuffer(e),this.view=new DataView(this.arrayBuffer),this.buffer=new Uint8Array(this.arrayBuffer)}send(e){let n=new Uint8Array(this.arrayBuffer,0,this.idx);e.send(n)}packInt8(e){this.view.setInt8(this.idx,e),this.idx++}packInt16(e){this.view.setInt16(this.idx,e,!0),this.idx+=2}packInt24(e){this.view.setInt16(this.idx,e&65535,!0),this.view.setInt8(this.idx+2,e>>16&255),this.idx+=3}packInt32(e){this.view.setInt32(this.idx,e,!0),this.idx+=4}packRadU(e){this.packInt24(e*2097152)}packRad(e){this.packInt16((e+Math.PI)*8192)}packFloat(e){this.packInt16(e*256)}packDouble(e){this.packInt32(e*1048576)}packString(e){if(typeof e!=="string")e="";this.packInt8(e.length);for(let n=0;n<e.length;n++)this.packInt16(e.charCodeAt(n))}packLongString(e){if(typeof e!=="string")e="";this.packInt16(e.length);for(let n=0;n<e.length;n++)this.packInt16(e.charCodeAt(n))}}var d=me;var zt={gameNotFound:4000,gameFull:4001,badName:4002,mainMenu:4003,gameIdleExceeded:4004,corruptedLoginData0:4005,corruptedLoginData1:4006,corruptedLoginData2:4007,corruptedLoginData3:4008,corruptedLoginData4:4009,corruptedLoginData5:4010,gameMaxPlayersExceeded:4011,gameDestroyUser:4012,joinGameOutOfOrder:4013,gameShuttingDown:4014,readyBeforeReady:4015,booted:4016,gameErrorOnUserSocket:4017,uuidNotFound:4018,sessionNotFound:4019,clusterFullCpu:4020,clusterFullMem:4021,noClustersAvailable:4022,locked:4023},xn=zt;var Dt={},u=Dt;var Qt=Object.fromEntries(Object.entries(Ne).map(([e,n])=>[n,e.toLowerCase()]));class Ke{constructor(e,n=null){if(this.id=e.id,this.uniqueId=e.uniqueId,this.name=e.name,this.safeName=e.safeName,this.team=e.team,this.playing=e.playing,this.socials=e.social&&JSON.parse(e.social),this.socials)this.socials.forEach((t)=>t.type=Qt[t.id]);if(this.isVip=e.upgradeProductId>0,this.showBadge=!e.hideBadge||!1,this.streak=e.score,this.streakRewards=Object.values(x).filter((t)=>e.activeShellStreaks&t),this.scale=this.streakRewards.includes(x.MiniEgg)?0.5:1,this.position={x:e.x,y:e.y,z:e.z},this.jumping=e.$controlKeys&O.Jump,this.scoping=e.$controlKeys&O.Scope,this.climbing=!1,this.view={yaw:e.yaw,pitch:e.pitch},this.updateKotcZone(n),this.character={eggColor:e.shellColor,primaryGun:e.primaryWeaponItem,secondaryGun:e.secondaryWeaponItem,stamp:e.stampItem,hat:e.hatItem,grenade:e.grenadeItem,melee:e.meleeItem,stampPos:{x:e.stampPosX,y:e.stampPosY}},this.stats={totalKills:e.totalKills,totalDeaths:e.totalDeaths,bestStreak:e.bestStreak},this.activeGun=e.weaponIdx,this.selectedGun=e.charClass,this.weapons=[],this.character.primaryGun)this.weapons[0]=Y(H[this.selectedGun]),this.weapons[1]=Y(ye);this.grenades=1,this.hp=e.hp,this.hpShield=0,this.spawnShield=e.shield,this.randomSeed=0}updateKotcZone(e){if(!e)return this.inKotcZone=!1;let n=Math.floor(this.position.x),t=Math.floor(this.position.y),i=Math.floor(this.position.z);this.inKotcZone=e.some((r)=>r.x===n&&r.y===t&&r.z===i)&&this.playing}}var re=Ke;var Xt=(e,n)=>(e%n+n)%n,Vt=Math.PI*2,Sn=(e)=>Math.round(e*8192)/8192,jt=(e)=>Sn(Xt(Math.atan2(-e.x,-e.z),Vt)),bt=(e)=>Sn(Math.atan2(e.y,Math.hypot(e.x,e.z)));class Un{constructor(e){this.pos=e}validate(){return this.pos&&this.pos.x&&this.pos.y&&this.pos.z}check(e){return e.me.playing}execute(e){let n={x:this.pos.x-e.me.position.x,y:this.pos.y-e.me.position.y,z:this.pos.z-e.me.position.z},t=jt(n),i=bt(n);e.state.yaw=t,e.state.pitch=i}}var ae=Un;class vn{constructor(e){if(typeof e==="number")this.inputKeys=e;else if(typeof e==="object")this.inputKeys=e.reduce((n,t)=>n|t,0)}validate(){if(typeof this.inputKeys!=="number")return!1;if(this.inputKeys&O.Forward&&this.inputKeys&O.Backward)return!1;if(this.inputKeys&O.Left&&this.inputKeys&O.Right)return!1;return!0}check(e){return e.me.playing}execute(e){e.state.controlKeys=this.inputKeys}}var Q=vn;class Tn{constructor(e,n,t=""){this.uniqueId=e,this.duration=n,this.reason=t}validate(e){if(typeof this.uniqueId!=="string"||typeof this.reason!=="string")return!1;if(typeof this.duration!=="number"||!Object.values(ve).some((n)=>this.duration===n))return!1;if(!(e.account.adminRoles&4))return!1;return!0}check(){return!0}execute(e){let n=new d;n.packInt8(u.banPlayer),n.packString(this.uniqueId),n.packString(this.reason),n.packInt8(this.duration),n.send(e.game.socket)}}var _e=Tn;class Rn{constructor(e){this.uniqueId=e}validate(e){return typeof this.uniqueId==="string"&&e.game.isGameOwner&&Object.values(e.players).find((n)=>n.uniqueId===this.uniqueId)}check(){return!0}execute(e){let n=new d;n.packInt8(u.bootPlayer),n.packString(this.uniqueId),n.send(e.game.socket)}}var qe=Rn;class On{constructor(e){this.msg=e}validate(){if(typeof this.msg!=="string")return!1;if(this.msg.length<1||this.msg.length>64)return!1;return!0}check(e){if(!e.state?.inGame)return!1;if(!e.game.isPrivate&&!e.account.adminRoles&&e.state.chatLines>=2)return!1;if(!e.game.isPrivate&&!e.account.emailVerified&&!e.account.isAged)return!1;return!0}execute(e){e.state.chatLines++;let n=new d;n.packInt8(u.chat),n.packString(this.msg),n.send(e.game.socket)}}var Ce=On;class Nn{constructor(e){this.amount=e||1}validate(){return this.amount>=1}check(e){return e.me.playing&&!e.state.reloading&&!e.state.swappingGun&&!e.state.usingMelee&&e.me.weapons[e.me.activeGun].ammo.rounds>=this.amount}execute(e){e.state.shotsFired+=this.amount||1}}var Ze=Nn;var ei=Array.from({length:4},(e,n)=>(n+1)*0.25),ni=Array.from({length:9},(e,n)=>n*0.25),ti=Array.from({length:17},(e,n)=>n*0.25),M=(e,n)=>typeof e>"u"?n:e;class Fn{constructor(e){this.changes=e}#e(e){let n={};if(n.gravity=M(this.changes.gravity,e.game.options.gravity),n.damage=M(this.changes.damage,e.game.options.damage),n.healthRegen=M(this.changes.healthRegen,e.game.options.healthRegen),n.locked=M(this.changes.locked,e.game.options.locked),n.noTeamChange=M(this.changes.noTeamChange,e.game.options.noTeamChange),n.noTeamShuffle=M(this.changes.noTeamShuffle,e.game.options.noTeamShuffle),n.weaponsDisabled=[M(this.changes.disableEggk,e.game.options.weaponsDisabled[0]),M(this.changes.disableScrambler,e.game.options.weaponsDisabled[1]),M(this.changes.disableFreeRanger,e.game.options.weaponsDisabled[2]),M(this.changes.disableRPG,e.game.options.weaponsDisabled[3]),M(this.changes.disableWhipper,e.game.options.weaponsDisabled[4]),M(this.changes.disableCrackshot,e.game.options.weaponsDisabled[5]),M(this.changes.disableTriHard,e.game.options.weaponsDisabled[6])],this.changes.toDisable&&Array.isArray(this.changes.toDisable))this.changes.toDisable.forEach((t)=>n.weaponsDisabled[t]=!0);if(this.changes.toEnable&&Array.isArray(this.changes.toEnable))this.changes.toEnable.forEach((t)=>n.weaponsDisabled[t]=!1);if(this.changes.rawWeaponsDisabled&&Array.isArray(this.changes.rawWeaponsDisabled)&&this.changes.rawWeaponsDisabled.length===7)n.weaponsDisabled=this.changes.rawWeaponsDisabled.map((t)=>!!t);return n.mustUseSecondary=n.weaponsDisabled.every((t)=>t),n}validate(e){let n=this.#e(e);if(!ei.includes(n.gravity))return!1;if(!ni.includes(n.damage))return!1;if(!ti.includes(n.healthRegen))return!1;if(typeof n.locked!=="boolean")return!1;if(typeof n.noTeamChange!=="boolean")return!1;if(typeof n.noTeamShuffle!=="boolean")return!1;if(!Array.isArray(n.weaponsDisabled))return!1;if(n.weaponsDisabled.length!==7)return!1;if(n.weaponsDisabled.some((t)=>typeof t!=="boolean"))return!1;return!0}check(e){return e.game.isGameOwner}execute(e){e.game.options=this.#e(e),e.updateGameOptions()}}var Be=Fn;class En{validate(e){return e.intents.includes(l.PATHFINDING)}check(e){return e.me.playing&&e.game.collectables[0].length}execute(e){let n=200,t=null;for(let c of e.game.collectables[0]){let o=c.x-e.me.position.x,p=c.y-e.me.position.y,m=c.z-e.me.position.z,f=Math.sqrt(o*o+p*p+m*m);if(f<n)n=f,t=c}let i=e.pathing.nodeList.atObject(e.me.position),r=e.pathing.nodeList.atObject(t),s=e.pathing.astar.path(i,r);if(!s)return e.$emit("pathfindError",$.NoPathFound);if(s.length<2)return e.$emit("pathfindError",$.PathTooShort);e.pathing.activePath=s,e.pathing.activeNode=e.pathing.activePath[1],e.pathing.activeNodeIdx=1}}var He=En;class An{validate(e){return e.intents.includes(l.PATHFINDING)}check(e){return e.me.playing&&e.game.kotc.zoneNumber&&e.game.kotc.activeZone}execute(e){let n=200,t=null;for(let c of e.game.kotc.activeZone){let o=c.x-e.me.position.x,p=c.y-e.me.position.y,m=c.z-e.me.position.z,f=Math.sqrt(o*o+p*p+m*m);if(f<n)n=f,t=c}let i=e.pathing.nodeList.atObject(e.me.position),r=e.pathing.nodeList.atObject(t),s=e.pathing.astar.path(i,r);if(!s)return e.$emit("pathfindError",$.NoPathFound);if(s.length<2)return e.$emit("pathfindError",$.PathTooShort);e.pathing.activePath=s,e.pathing.activeNode=e.pathing.activePath[1],e.pathing.activeNodeIdx=1}}var Ye=An;class Gn{validate(e){return e.intents.includes(l.PATHFINDING)}check(e){return e.me.playing&&e.game.collectables[1].length}execute(e){let n=200,t=null;for(let c of e.game.collectables[1]){let o=c.x-e.me.position.x,p=c.y-e.me.position.y,m=c.z-e.me.position.z,f=Math.sqrt(o*o+p*p+m*m);if(f<n)n=f,t=c}let i=e.pathing.nodeList.atObject(e.me.position),r=e.pathing.nodeList.atObject(t),s=e.pathing.astar.path(i,r);if(!s)return e.$emit("pathfindError",$.NoPathFound);if(s.length<2)return e.$emit("pathfindError",$.PathTooShort);e.pathing.activePath=s,e.pathing.activeNode=e.pathing.activePath[1],e.pathing.activeNodeIdx=1}}var Je=Gn;class $n{idOrName;constructor(e){this.idOrName=e}validate(e){if(!e.intents.includes(l.PATHFINDING))return!1;if(typeof this.idOrName!=="string"&&typeof this.idOrName!=="number")return!1;return!!(e.players[this.idOrName.toString()]||e.players.find((t)=>t.name===this.idOrName))}check(e){if(!e.me.playing)return!1;let n=e.players[this.idOrName.toString()]||e.players.find((t)=>t.name===this.idOrName);return n&&n.playing&&n.position&&n.position.x}execute(e){let n=e.players[this.idOrName.toString()]||e.players.find((s)=>s.name===this.idOrName),t=e.pathing.nodeList.atObject(e.me.position),i=e.pathing.nodeList.atObject(n.position),r=e.pathing.astar.path(t,i);if(!r)return e.$emit("pathfindError",$.NoPathFound);if(r.length<2)return e.$emit("pathfindError",$.PathTooShort);e.pathing.activePath=r,e.pathing.activeNode=e.pathing.activePath[1],e.pathing.activeNodeIdx=1}}var ze=$n;class Mn{validate(e){return e.intents.includes(l.PATHFINDING)}check(e){return e.me.playing&&e.game.spatula&&e.game.spatula.coords&&e.game.spatula.coords.x}execute(e){let n=e.pathing.nodeList.atObject(e.me.position),t=e.pathing.nodeList.atObject(e.game.spatula.coords),i=e.pathing.astar.path(n,t);if(!i)return e.$emit("pathfindError",$.NoPathFound);if(i.length<2)return e.$emit("pathfindError",$.PathTooShort);e.pathing.activePath=i,e.pathing.activeNode=e.pathing.activePath[1],e.pathing.activeNodeIdx=1}}var De=Mn;var ii=(e,n)=>(e%n+n)%n,ri=Math.PI*2,Ln=(e)=>Math.round(e*8192)/8192,ai=(e)=>Ln(ii(Math.atan2(-e.x,-e.z),ri)),si=(e)=>Ln(Math.atan2(e.y,Math.hypot(e.x,e.z)));class Wn{idOrName;constructor(e){this.idOrName=e}validate(e){if(typeof this.idOrName!=="string"&&typeof this.idOrName!=="number")return!1;return!!(e.players[this.idOrName.toString()]||e.players.find((t)=>t.name===this.idOrName))}check(e){if(!e.me.playing)return!1;let n=e.players[this.idOrName.toString()]||e.players.find((t)=>t.name===this.idOrName);return n&&n.playing&&n.position&&n.position.x}execute(e){let n=e.players[this.idOrName.toString()]||e.players.find((s)=>s.name===this.idOrName),t={x:n.position.x-e.me.position.x,y:n.position.y-e.me.position.y-0.05,z:n.position.z-e.me.position.z},i=ai(t),r=si(t);e.state.yaw=i,e.state.pitch=r}}var Qe=Wn;class Kn{validate(){return!0}check(e){return e.me.playing&&!e.state.reloading&&!e.state.swappingGun&&!e.state.usingMelee}execute(e){let n=new d;n.packInt8(u.melee),n.send(e.game.socket),e.usingMelee=!0,setTimeout(()=>{e.usingMelee=!1,e.swappingGun=!0,setTimeout(()=>{e.swappingGun=!1},0.5*Oe)},566.6666666666667)}}var Xe=Kn;class _n{validate(){return!0}check(e){return e.me.playing}execute(e){let n=new d;n.packInt8(u.pause),n.send(e.game.socket),setTimeout(()=>e.me.playing=!1,3000)}}var Ve=_n;class qn{validate(){return!0}check(e){return e.me.playing&&!e.state.reloading&&!e.state.swappingGun&&!e.state.usingMelee}execute(e){let n=new d;n.packInt8(u.reload),n.send(e.game.socket);let t=e.me.weapons[e.me.activeGun];if(t.ammo){let s=Math.min(Math.min(t.ammo.capacity,t.ammo.reload)-t.ammo.rounds,t.ammo.store);t.ammo.rounds+=s,t.ammo.store-=s}e.$emit("playerReload",e.me,t);let i=e.me.weapons[e.me.activeGun],r=i.ammo.rounds<1;e.state.reloading=!0,setTimeout(()=>e.state.reloading=!1,r?i.longReloadTime:i.shortReloadTime)}}var je=qn;class Cn{constructor(e,n={}){if(this.idOrName=e,this.reasons=[!!n.cheating,!!n.harassment,!!n.offensive,!!n.other],!this.reasons.includes(!0))this.reasons[3]=!0;for(let t=0;t<this.reasons.length;t++)if(this.reasons[t]===!0)this.reasonInt|=1<<t}validate(e){if(typeof this.idOrName!=="string"&&typeof this.idOrName!=="number")return!1;if(this.reasons.every((n)=>n===!1))return!1;if(!e.players[this.idOrName.toString()]&&!e.players.find((n)=>n.name===this.idOrName))return!1;return!0}check(e){if(!e.state.inGame)return!1;return!!(e.players[this.idOrName.toString()]||e.players.find((t)=>t.name===this.idOrName))}execute(e){let n=e.players[this.idOrName.toString()]||e.players.find((i)=>i.name===this.idOrName),t=new d;t.packInt8(u.reportPlayer),t.packString(n.uniqueId),t.packInt8(this.reasonInt),t.send(e.game.socket)}}var be=Cn;class Zn{validate(){return!0}check(e){return e.game.isGameOwner}execute(e){let n=new d;n.packInt8(u.gameAction),n.packInt8(z.Reset),n.send(e.game.socket)}}var en=Zn;var X=(e)=>w(e)&&w(e).unlock==="default",V=(e,n)=>w(e)&&w(e).item_type_id===n;class Bn{constructor(e){this.changes={classIdx:e.gunId,hatId:e.hatId,stampId:e.stampId,grenadeId:e.grenadeId,meleeId:e.meleeId,colorIdx:e.eggColor,primaryId:e.primaryIds,secondaryId:e.secondaryIds},this.changes=Object.fromEntries(Object.entries(this.changes).filter(([,n])=>!!n))}validate(e){let n=this.changes;if(n.colorIdx&&n.colorIdx>=7&&!e.account.vip)return!1;if(n.colorIdx&&n.colorIdx>=14)return!1;if(V(n.hatId,W.Hat)&&!X(n.hatId)&&!e.account.ownedItemIds.includes(n.hatId))return!1;if(V(n.stampId,W.Stamp)&&!X(n.stampId)&&!e.account.ownedItemIds.includes(n.stampId))return!1;if(V(n.grenadeId,W.Grenade)&&!X(n.grenadeId)&&!e.account.ownedItemIds.includes(n.grenadeId))return!1;if(V(n.meleeId,W.Melee)&&!X(n.meleeId)&&!e.account.ownedItemIds.includes(n.meleeId))return!1;if(typeof n.classIdx==="number"&&n.classIdx>6||n.classIdx<0)return!1;if(this.changes.primaryId)for(let t=0;t<7;t++){let i=this.changes.primaryId[t];if(!V(i,W.Primary)||!X(i)&&!e.account.ownedItemIds.includes(i))return!1}if(this.changes.secondaryId)for(let t=0;t<7;t++){let i=this.changes.secondaryId[t];if(!V(i,W.Secondary)||!X(i)&&!e.account.ownedItemIds.includes(i))return!1}return!0}check(e){return!e.me.playing}execute(e){if(e.me&&this.changes.classIdx&&this.changes.classIdx!==e.me.selectedGun)e.me.weapons[0]=Y(H[this.changes.classIdx]);e.state.weaponIdx=this.changes.classIdx||e.state.weaponIdx;let n={...e.account.loadout,...this.changes},t=e.api.queryServices({cmd:"saveLoadout",save:!0,firebaseId:e.account.firebaseId,sessionId:e.account.sessionId,loadout:n});if(e.account.loadout=n,e.me)t.then(()=>{if(e.state.inGame){let r=new d;r.packInt8(u.changeCharacter),r.packInt8(this.changes?.classIdx||e.me.selectedGun),r.send(e.game.socket)}let i=e.intents.includes(l.COSMETIC_DATA);Object.entries(this.changes).forEach(([r,s])=>{if(r==="classIdx")e.me.selectedGun=s;else if(r==="hatId")e.me.character.hat=i?w(s):s;else if(r==="stampId")e.me.character.stamp=i?w(s):s;else if(r==="grenadeId")e.me.character.grenade=i?w(s):s;else if(r==="meleeId")e.me.character.melee=i?w(s):s;else if(r==="colorIdx")e.me.character.eggColor=s;else if(r==="primaryId")e.me.character.primaryGun=i?w(s[e.me.selectedGun]):s;else if(r==="secondaryId")e.me.character.secondaryGun=i?w(s[e.me.selectedGun]):s})})}}var nn=Bn;class Hn{validate(){return!0}check(e){if(e.me.playing)return!1;if(e.intents.includes(l.OBSERVE_GAME))return!1;return!0}execute(e){let n=new d;n.packInt8(u.requestRespawn),n.send(e.game.socket),e.state.buffer=[]}}var tn=Hn;class Yn{constructor(e){this.manualWeapon=e}validate(){return typeof this.manualWeapon==="number"||typeof this.manualWeapon>"u"}check(e){return e.me.playing&&!e.state.reloading&&!e.state.swappingGun&&!e.state.usingMelee}execute(e){let n=+!e.me.activeGun;if(typeof this.manualWeapon==="number")n=this.manualWeapon;e.me.activeGun=n;let t=new d;t.packInt8(u.swapWeapon),t.packInt8(e.me.activeGun),t.send(e.game.socket)}}var rn=Yn;class Jn{validate(){return!0}check(e){if(!e.state.inGame||e.me.playing)return!1;if(e.game.gameModeId===0)return!1;if(e.intents.includes(l.OBSERVE_GAME))return!1;if(e.game.isPrivate)return!e.game.options.noTeamChange;let n=e.players,t=e.me.team,i=n.filter((s)=>s.team===t).length,r=n.filter((s)=>s.team!==t).length;if(r>i)return!1;if(i===r)return!1;return!0}execute(e){let n=new d;n.packInt8(u.switchTeam),n.send(e.game.socket)}}var an=Jn;class zn{constructor(e=1){this.power=e}validate(){return typeof this.power==="number"&&this.power>=0&&this.power<=1}check(e){return e.me.playing&&!e.state.reloading&&!e.state.swappingGun&&!e.state.usingMelee}execute(e){let n=new d;n.packInt8(u.throwGrenade),n.packFloat(this.power),n.send(e.game.socket)}}var sn=zn;var Dn={banPlayer:_e,bootPlayer:qe,chat:Ce,fire:Ze,gameOptions:Be,goToAmmo:He,goToCoop:Ye,goToGrenade:Je,goToPlayer:ze,goToSpatula:De,lookAt:Qe,lookAtPos:ae,melee:Xe,movement:Q,pause:Ve,reload:je,reportPlayer:be,resetGame:en,saveLoadout:nn,spawn:tn,swapWeapon:rn,switchTeam:an,throwGrenade:sn},ci={BanPlayerDispatch:_e,BootPlayerDispatch:qe,ChatDispatch:Ce,FireDispatch:Ze,GameOptionsDispatch:Be,GoToAmmoDispatch:He,GoToCoopDispatch:Ye,GoToGrenadeDispatch:Je,GoToPlayerDispatch:ze,GoToSpatulaDispatch:De,LookAtDispatch:Qe,LookAtPosDispatch:ae,MeleeDispatch:Xe,MovementDispatch:Q,PauseDispatch:Ve,ReloadDispatch:je,ReportPlayerDispatch:be,ResetGameDispatch:en,SaveLoadoutDispatch:nn,SpawnDispatch:tn,SwapWeaponDispatch:rn,SwitchTeamDispatch:an,ThrowGrenadeDispatch:sn};var oi=(e)=>new Uint8Array(e.match(/.{2}/g).map((n)=>parseInt(n,16))),pi=new TextEncoder,Qn=async(e)=>{if(typeof process<"u"&&typeof process.getBuiltinModule==="function"){let r=process.getBuiltinModule("node:crypto"),s=Buffer.from("3496afa51f2a553ea1fc5211400c000b","hex");return r.createHmac("sha256",s).update(e).digest("hex")}let n=oi("3496afa51f2a553ea1fc5211400c000b"),t=await crypto.subtle.importKey("raw",n,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),i=await crypto.subtle.sign("HMAC",t,pi.encode(e));return Array.from(new Uint8Array(i)).map((r)=>r.toString(16).padStart(2,"0")).join("")},Z=(e)=>{return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)},Xn=(e,n)=>{let t=Math.round(e/(Math.PI*2)*65535),i=0,r=Math.round((n+1.5)/3*32767),s=t<0?0:t;t=s>65535?65535:s;let c=Math.trunc(t);if(c<0)c=0;if(c>4294967295)c=4294967295;c=t>=0?c:0,c=t>65535?0:c;let o=c;i^=o;let p=r<0?0:r;t=p,p=t>32767?32767:t,t=p;let m=Math.trunc(t);if(m<0)m=0;if(m>4294967295)m=4294967295;m=t>=0?m:0,m=t>65535?0:m;let f=m,g=(f^4294934528)&65535,h=i^g,I=h&255,S=i<<8,U=(i&65280)>>>8;f=(S|U)>>>0;let v=I^f;h=h<<8|(h&65280)>>>8,o^=g,g=h^o&255,o=o<<8|(o&65280)>>8,i=o^i&255;let P=[];return P[3]=Z(g&63),P[7]=Z(f>>>8&63),P[4]=Z(h>>>10&63),P[0]=Z((i&252)>>>2),P[5]=Z(h>>>4&48|v>>>4&15),P[2]=Z(o>>>6&60|g>>>6&3),P[6]=Z((f>>>14&3|v<<2)&63),P[1]=Z((o>>>12&15|i<<4)&63),String.fromCharCode(...P)};var Vn=[];var se=[];var cn=[];var ui=(e)=>{let n=a.unPackInt8U(),t=e.intents.includes(l.COSMETIC_DATA),i={id:n,uniqueId:a.unPackString(),name:a.unPackString(),safeName:a.unPackString(),charClass:a.unPackInt8U(),team:a.unPackInt8U(),primaryWeaponItem:t?w(a.unPackInt16U()):a.unPackInt16U(),secondaryWeaponItem:t?w(a.unPackInt16U()):a.unPackInt16U(),shellColor:a.unPackInt8U(),hatItem:t?w(a.unPackInt16U()):a.unPackInt16U(),stampItem:t?w(a.unPackInt16U()):a.unPackInt16U(),stampPosX:a.unPackInt8(),stampPosY:a.unPackInt8(),grenadeItem:t?w(a.unPackInt16U()):a.unPackInt16U(),meleeItem:t?w(a.unPackInt16U()):a.unPackInt16U(),x:a.unPackFloat(),y:a.unPackFloat(),z:a.unPackFloat(),$dx:a.unPackFloat(),$dy:a.unPackFloat(),$dz:a.unPackFloat(),yaw:a.unPackRadU(),pitch:a.unPackRad(),score:a.unPackInt32U(),$kills:a.unPackInt16U(),$deaths:a.unPackInt16U(),$streak:a.unPackInt16U(),totalKills:a.unPackInt32U(),totalDeaths:a.unPackInt32U(),bestStreak:a.unPackInt16U(),$bestOverallStreak:a.unPackInt16U(),shield:a.unPackInt8U(),hp:a.unPackInt8U(),playing:a.unPackInt8U(),weaponIdx:a.unPackInt8U(),$controlKeys:a.unPackInt8U(),upgradeProductId:a.unPackInt8U(),activeShellStreaks:a.unPackInt8U(),social:a.unPackLongString(),hideBadge:a.unPackInt8U()};e.game.mapIdx=a.unPackInt8U(),e.game.isPrivate=a.unPackInt8U()===1,e.game.gameModeId=a.unPackInt8U();let r=new re(i,e.game.gameMode===T.KOTC?e.game.kotc.activeZone:null);if(!e.players[i.id])e.players[i.id]=r;if(e.$emit("playerJoin",r),e.me.id===i.id)e.me=r,e.$emit("botJoin",e.me)},jn=ui;var mi=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=e.players[n];if(!i)return;switch(t){case x.HardBoiled:if(n===e.me.id)e.me.shieldHp=100;i.streakRewards.push(x.HardBoiled);break;case x.EggBreaker:i.streakRewards.push(x.EggBreaker);break;case x.Restock:{if(i.grenades=3,i.weapons[0]&&i.weapons[0].ammo)i.weapons[0].ammo.rounds=i.weapons[0].ammo.capacity,i.weapons[0].ammo.store=i.weapons[0].ammo.storeMax;if(i.weapons[1]&&i.weapons[1].ammo)i.weapons[1].ammo.rounds=i.weapons[1].ammo.capacity,i.weapons[1].ammo.store=i.weapons[1].ammo.storeMax;break}case x.OverHeal:i.hp=Math.min(200,i.hp+100),i.streakRewards.push(x.OverHeal);break;case x.DoubleEggs:i.streakRewards.push(x.DoubleEggs);break;case x.MiniEgg:i.scale=0.5,i.streakRewards.push(x.MiniEgg);break}e.$emit("playerBeginStreak",i,t)},bn=mi;var fi=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=e.players[n];if(!i)return;if(!e.intents.includes(l.CHALLENGES))return e.$emit("challengeComplete",i,t);let r=e.account.challenges.find((s)=>s.id===t);if(e.$emit("challengeComplete",i,r),i.id===e.me.id)e.refreshChallenges()},et=fi;var hi=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=a.unPackInt16U(),r=a.unPackInt16U(),s=a.unPackInt8U(),c=a.unPackInt16U(),o=a.unPackInt16U(),p=a.unPackInt16U(),m=a.unPackInt16U(),f=a.unPackInt8(),g=a.unPackInt8(),h=e.intents.includes(l.COSMETIC_DATA),I=h?w(i):i,S=h?w(r):r,U=h?w(c):c,y=h?w(o):o,v=h?w(p):p,E=h?w(m):m,P=e.players[n];if(P){let R=structuredClone(P.character),F=P.selectedGun;if(P.character.eggColor=s,P.character.primaryGun=I,P.character.secondaryGun=S,P.character.stamp=y,P.character.hat=U,P.character.grenade=v,P.character.melee=E,P.character.stampPos.x=f,P.character.stampPos.y=g,P.selectedGun=t,P.weapons[0]=Y(H[t]),F!==P.selectedGun)e.$emit("playerChangeGun",P,F,P.selectedGun);if(R!==P.character)e.$emit("playerChangeCharacter",P,R,P.character)}},nt=hi;var li=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=a.unPackString().valueOf(),r=e.players[n];e.$emit("chat",r,i,t)},tt=li;var ki=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=a.unPackInt8U(),r=a.unPackInt16U(),s=e.players[n];if(!s)return;if(e.game.collectables[t]=e.game.collectables[t].filter((c)=>c.id!==r),t===oe.Ammo){let c=s.weapons[i];if(c&&c.ammo)c.ammo.store=Math.min(c.ammo.storeMax,c.ammo.store+c.ammo.pickup),e.$emit("playerCollectAmmo",s,c,r)}if(t===oe.Grenade){if(s.grenades++,s.grenades>3)s.grenades=3;e.$emit("playerCollectGrenade",s,r)}},it=ki;var gi=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U();a.unPackInt8U(),a.unPackInt8U();let i=a.unPackInt8U(),r=e.players[n],s=e.players[t],c=r?structuredClone(r):null;if(r){if(r.id===e.me.id){if(e.lastDeathTime=Date.now(),e.pathing.activePath)e.pathing.activePath=null,e.pathing.activeNode=null,e.pathing.activeNodeIdx=0;e.state.controlKeys=0}r.playing=!1,r.streak=0,r.hp=100,r.spawnShield=0,r.stats.totalDeaths++,r.inKotcZone=!1,e.$emit("playerLeaveZone",r,q.Killed)}if(s){if(s.streak++,s.stats.totalKills++,s.streak>s.stats.bestStreak)s.stats.bestStreak=s.streak}e.$emit("playerDeath",r,s,c,i)},rt=gi;var Pi=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=e.players[n];if(!i)return;if([x.EggBreaker,x.OverHeal,x.DoubleEggs,x.MiniEgg].includes(t)&&i.streakRewards.includes(t))i.streakRewards=i.streakRewards.filter((s)=>s!==t);if(t===x.MiniEgg)i.scale=1;e.$emit("playerEndStreak",i,t)},at=Pi;var di=(e)=>{let n=new d;n.packInt8(u.eventModifier),n.send(e.game.socket)},st=di;var Ii=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt16U(),i=a.unPackFloat(),r=a.unPackFloat(),s=a.unPackFloat(),c=a.unPackInt8U(),o=a.unPackFloat();if(e.intents.includes(l.COSMETIC_DATA))t=w(t);if(n===W.Grenade)e.$emit("grenadeExplode",t,{x:i,y:r,z:s},c,o);else e.$emit("rocketHit",{x:i,y:r,z:s},c,o)},ct=Ii;var yi=(e)=>{let n=a.unPackInt8U(),t={posX:a.unPackFloat(),posY:a.unPackFloat(),posZ:a.unPackFloat(),dirX:a.unPackFloat(),dirY:a.unPackFloat(),dirZ:a.unPackFloat()},i=e.players[n];if(!i)return;let r=i.weapons[i.activeGun];if(r&&r.ammo)r.ammo.rounds--,e.$emit("playerFire",i,r,t)},ot=yi;var wi=(e)=>{let n=a.unPackInt8U();if(n===z.Pause)e.$emit("gameForcePause"),setTimeout(()=>e.me.playing=!1,3000);if(n===z.Reset){if(Object.values(e.players).forEach((t)=>t.streak=0),e.game.gameModeId!==T.FFA)e.game.teamScore=[0,0,0];if(e.game.gameModeId===T.Spatula)e.game.spatula.controlledBy=0,e.game.spatula.controlledByTeam=0,e.game.spatula.coords={x:0,y:0,z:0};if(e.game.gameModeId===T.KOTC)e.game.kotc.stage=b.Capturing,e.game.kotc.zoneNumber=0,e.game.kotc.activeZone=null,e.game.kotc.capturing=0,e.game.kotc.captureProgress=0,e.game.kotc.numCapturing=0,e.game.kotc.capturePercent=0;e.$emit("gameReset")}},pt=wi;class fe{constructor(e){this.list=e}heuristic(e,n){let t=Math.abs(e.x-n.x),i=Math.abs(e.y-n.y),r=Math.abs(e.z-n.z),s=Math.max(t,r);return i+s}reversePath(e){let n=[];while(e.parent)n.push(e),e=e.parent;return n.reverse(),n}path(e,n){this.list.clean();let t=[e],i=new Set;e.h=this.heuristic(e,n),e.g=0,e.f=e.h,e.visited=!0;let r;while(t.length>0){let s=0,c=t[0].f,o=t[0].g;for(let m=1;m<t.length;m++){let f=t[m];if(f.f<c||f.f===c&&f.g>o)c=f.f,o=f.g,s=m}if(r=t[s],r===n)return this.reversePath(r);t[s]=t[t.length-1],t.pop(),i.add(r);let p=r.links;for(let m=0;m<p.length;m++){let f=p[m];if(i.has(f))continue;let g=r.g+1;if(!f.visited||g<f.g){let h=!f.visited;if(f.visited=!0,f.parent=r,f.g=g,f.h=this.heuristic(f,n),f.f=f.g+f.h,h)t.push(f)}}}return null}}var on=Object.freeze({0:{x:0,z:-1},1:{x:-1,z:0},2:{x:0,z:1},3:{x:1,z:0}}),j=(e,n,t)=>(e&255)<<16|(n&255)<<8|t&255;class pn{constructor(e,n){if(this.x=n.x,this.y=n.y,this.z=n.z,this.positionKey=j(this.x,this.y,this.z),this.meshType=e.split(".").pop(),this.f=0,this.g=0,this.h=0,this.visited=null,this.parent=null,this.closed=null,this.links=[],this.flatCenter={x:this.x+0.5,y:this.y,z:this.z+0.5},this.meshType==="wedge")this.ry=n.ry??0}isFull(){return this.meshType==="full"}canWalkThrough(){return this.meshType==="none"||this.meshType==="ladder"}canWalkOn(){return this.meshType==="full"}isLadder(){return this.meshType==="ladder"}isStair(){return this.meshType==="wedge"}isAir(){return this.meshType==="none"}isJumpPad(){return this.meshType==="jump-pad"}canLink(e,n){let t=this.x-e.x,i=this.z-e.z,r=this.y-e.y,s=Math.abs(t),c=Math.abs(r),o=Math.abs(i);if(s+c+o===0||s+o>1&&!(s===2&&o===1||s===1&&o===2||s===2&&o===2)||this.isFull()||e.isFull())return!1;let p=n.at(this.x,this.y-1,this.z),m=n.at(e.x,e.y-1,e.z);if(!p||!m)return!1;if(c===0&&p.isFull()&&m.isFull()){if(s===2&&o===0||s===0&&o===2){let h=(this.x+e.x)/2,I=(this.z+e.z)/2,S=n.at(h,this.y,I),U=n.at(h,this.y-1,I),y=n.at(h,this.y+1,I);if(U&&U.isAir()){if(S&&S.isAir()&&y&&y.isAir()){let v=n.at(this.x,this.y+1,this.z),E=n.at(e.x,e.y+1,e.z);if(v&&v.isAir()&&E&&E.isAir())return!0}}}else if(s===2&&o===1||s===1&&o===2){let h=t>0?-1:1,I=i>0?-1:1,S=s===2?[[this.x+h,this.y,this.z],[this.x+h,this.y,this.z+I]]:[[this.x,this.y,this.z+I],[this.x+h,this.y,this.z+I]],U=!0;for(let[y,v,E]of S){let P=n.at(y,v,E),R=n.at(y,v-1,E),F=n.at(y,v+1,E);if(!P||!P.isAir()||!R||!R.isAir()||!F||!F.isAir()){U=!1;break}}if(U){let y=n.at(this.x,this.y+1,this.z),v=n.at(e.x,e.y+1,e.z);if(y&&y.isAir()&&v&&v.isAir())return!0}}else if(s===2&&o===2){let h=t>0?-1:1,I=i>0?-1:1,S=[[this.x+h,this.y,this.z+I],[this.x+h,this.y,this.z+I],[this.x+2*h,this.y,this.z+2*I]],U=!0;for(let[y,v,E]of S){let P=n.at(y,v,E),R=n.at(y,v-1,E),F=n.at(y,v+1,E);if(!P||!P.isAir()||!R||!R.isAir()||!F||!F.isAir()){U=!1;break}}if(U){let y=n.at(this.x,this.y+1,this.z),v=n.at(e.x,e.y+1,e.z);if(y&&y.isAir()&&v&&v.isAir())return!0}}}let f=p.isFull()||this.isStair(),g=m.isFull()||m.isStair()||e.isStair();if(c<=2&&f&&g){if(this.meshType==="none"){if(r===1&&e.canWalkThrough())return!0;if(p.canWalkOn()||p.isLadder()||p.isStair()){if(e.meshType==="none"||e.meshType==="ladder"&&c===0||e.meshType==="wedge"&&r===0&&t===-on[e.ry].x&&i===-on[e.ry].z)return!0}return!1}else if(this.meshType==="ladder"){if(c===1&&e.canWalkThrough())return!0;if(c===0&&p.canWalkOn())return!0;return e.meshType==="ladder"&&(c===1||p.canWalkOn()&&m.canWalkOn())}else if(this.meshType==="wedge"){let h=on[this.ry],I={x:-h.x,z:-h.z};if(this.x+h.x===e.x&&this.z+h.z===e.z){if(this.y+1===e.y&&e.canWalkThrough())return!0;if(this.y===e.y&&e.meshType==="wedge")return!0;if(this.y+1===e.y&&e.meshType==="wedge")return!0}if(this.x+I.x===e.x&&this.z+I.z===e.z){if((this.y===e.y||this.y-1===e.y)&&e.canWalkThrough())return!0;if(this.y-1===e.y&&(e.meshType==="wedge"||e.meshType==="none"&&m.isFull()))return!0}if(e.canWalkThrough()&&(m.isFull()||m.isStair()))return!0;if(e.isStair())return!0;return!1}}}flatRadialDistance(e){return Math.hypot(this.flatCenter.x-e.x,this.flatCenter.z-e.z)}}var xi=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1],[1,0,1],[1,0,-1],[-1,0,1],[-1,0,-1],[1,1,0],[-1,1,0],[0,1,1],[0,1,-1],[1,-1,0],[-1,-1,0],[0,-1,1],[0,-1,-1],[2,0,0],[-2,0,0],[0,0,2],[0,0,-2],[2,0,1],[2,0,-1],[-2,0,1],[-2,0,-1],[1,0,2],[1,0,-2],[-1,0,2],[-1,0,-2],[2,0,2],[2,0,-2],[-2,0,2],[-2,0,-2]];class un{list=[];nodeMap=null;constructor(e){let n=new Set;for(let t of Object.keys(e.data))for(let i of e.data[t])n.add(j(i.x,i.y,i.z)),this.list.push(new pn(t,i));for(let t=0;t<e.width;t++)for(let i=0;i<e.height;i++)for(let r=0;r<e.depth;r++)if(!n.has(j(t,i,r)))this.list.push(new pn("SPECIAL.air.none",{x:t,y:i,z:r}));this.nodeMap=new Map;for(let t of this.list)this.nodeMap.set(t.positionKey,t);for(let t of this.list)for(let[i,r,s]of xi){let c=j(t.x+i,t.y+r,t.z+s),o=this.nodeMap.get(c);if(o&&t.canLink(o,this))t.links.push(o)}}at(e,n,t){return this.nodeMap?.get(j(e,n,t))}atObject({x:e,y:n,z:t}){return this.nodeMap?.get(j(Math.floor(e),Math.floor(n),Math.floor(t)))}clean(){for(let e of this.list)e.f=0,e.g=0,e.h=0,e.visited=null,e.parent=null,e.closed=null}hasLineOfSight(e,n){let t=n.x-e.x,i=n.y-e.y,r=n.z-e.z,s=Math.max(Math.abs(t),Math.abs(i),Math.abs(r)),c=t/s,o=i/s,p=r/s,m=e.x,f=e.y,g=e.z;for(let h=0;h<=s;h++){if(this.at(Math.round(m),Math.round(f),Math.round(g))?.isFull())return!1;m+=c,f+=o,g+=p}return!0}}var Si=Object.fromEntries(Object.entries(T).map(([e,n])=>[n,e])),Ui=async(e)=>{if(e.me.id=a.unPackInt8U(),e.me.team=a.unPackInt8U(),e.game.gameModeId=a.unPackInt8U(),e.game.gameMode=Si[e.game.gameModeId],e.game.mapIdx=a.unPackInt8U(),e.game.map=se[e.game.mapIdx],e.game.playerLimit=a.unPackInt8U(),e.game.isGameOwner=a.unPackInt8U()===1,e.game.isPrivate=a.unPackInt8U()===1||e.game.isGameOwner,a.unPackInt8U(),e.intents.includes(l.LOAD_MAP)||e.intents.includes(l.PATHFINDING)){let t=await In(e.game.map.filename,e.game.map.hash);if(e.game.map)e.game.map.raw=t;if(e.game.gameModeId===T.KOTC){let i=e.game.map.raw.data["DYNAMIC.capture-zone.none"];if(i){if(e.game.map.zones=yn(i),!e.game.kotc.activeZone)e.game.kotc.activeZone=e.game.map.zones[e.game.kotc.zoneNumber-1]}else delete e.game.map.zones}if(e.intents.includes(l.PATHFINDING))e.pathing.nodeList=new un(e.game.map.raw),e.pathing.astar=new fe(e.pathing.nodeList);e.$emit("mapLoad",e.game.map.raw)}e.state.inGame=!0,e.lastDeathTime=Date.now();let n=new d;if(n.packInt8(u.clientReady),n.send(e.game.socket),e.updateIntervalId=setInterval(()=>e.update(),33.333333333333336),e.intents.includes(l.PING)){e.lastPingTime=Date.now();let t=new d;t.packInt8(u.ping),t.send(e.game.socket)}if(e.intents.includes(l.NO_AFK_KICK))e.afkKickInterval=setInterval(()=>{if(e.state.inGame&&!e.me.playing&&Date.now()-e.lastDeathTime>=15000){let t=new d;t.packInt8(u.keepAlive),t.send(e.game.socket)}},15000);e.$emit("gameReady")},ut=Ui;var mt=Object.fromEntries(Object.entries(Re).map(([e,n])=>[e[0].toLowerCase()+e.slice(1),n])),vi=(e)=>{let n=structuredClone(e.game.options),t=a.unPackInt8U(),i=a.unPackInt8U(),r=a.unPackInt8U();if(t<1||t>4)t=4;if(i<0||i>8)i=4;if(r>16)r=4;e.game.options.gravity=t/4,e.game.options.damage=i/4,e.game.options.healthRegen=r/4;let s=a.unPackInt8U();Object.keys(mt).forEach((c)=>{let o=s&mt[c]?1:0;e.game.options[c]=o}),e.game.options.weaponsDisabled=Array.from({length:7},()=>a.unPackInt8U()===1),e.game.options.mustUseSecondary=e.game.options.weaponsDisabled.every((c)=>c),e.$emit("gameOptionsChange",n,e.game.options)},ft=vi;var Ti=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=a.unPackFloat(),r=a.unPackFloat();if(!e.me)return;if(e.me.shieldHp=n,e.me.hp=t,e.me.shieldHp<=0)e.me.streakRewards=e.me.streakRewards.filter((s)=>s!==x.HardBoiled),e.$emit("selfShieldLost",e.me.hp,{dx:i,dz:r});else e.$emit("selfShieldHit",e.me.shieldHp,e.me.hp,{dx:i,dz:r})},ht=Ti;var Ri=(e)=>{let n=a.unPackInt8U();a.unPackFloat(),a.unPackFloat();let t=e.me.hp;e.me.hp=n,e.$emit("playerDamage",e.me,t,e.me.hp)},lt=Ri;var Oi=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=e.players[n];if(!i)return;let r=i.hp;i.hp=t,e.$emit("playerDamage",i,r,i.hp)},kt=Oi;var Ni=(e)=>{let n=a.unPackInt8U(),t=e.players[n];if(t)e.$emit("playerMelee",t)},gt=Ni;var Fi=(e)=>{if(e.game.gameModeId===T.Spatula){let n=structuredClone(e.game.teamScore),t=structuredClone(e.game.spatula);e.game.teamScore[1]=a.unPackInt16U(),e.game.teamScore[2]=a.unPackInt16U();let i={x:a.unPackFloat(),y:a.unPackFloat(),z:a.unPackFloat()},r=a.unPackInt8U(),s=a.unPackInt8U();e.game.spatula={coords:i,controlledBy:r,controlledByTeam:s},e.$emit("gameStateChange",{teamScore:{before:n,after:e.game.teamScore},spatula:{before:t,after:e.game.spatula}})}else if(e.game.gameModeId===T.KOTC){let n=structuredClone(e.game.teamScore),t=structuredClone(e.game.kotc),i=Object.values(e.players).filter((r)=>r.inKotcZone&&r.playing);if(e.game.kotc.stage=a.unPackInt8U(),e.game.kotc.zoneNumber=a.unPackInt8U(),e.game.kotc.capturing=a.unPackInt8U(),e.game.kotc.captureProgress=a.unPackInt16U(),e.game.kotc.numCapturing=a.unPackInt8U(),e.game.teamScore[1]=a.unPackInt8U(),e.game.teamScore[2]=a.unPackInt8U(),e.game.kotc.capturePercent=e.game.kotc.captureProgress/1000,e.game.kotc.activeZone=e.game.map.zones?e.game.map.zones[e.game.kotc.zoneNumber-1]:null,e.game.kotc.activeZone)Object.values(e.players).forEach((r)=>r.updateKotcZone(e.game.kotc.activeZone));if(e.game.kotc.numCapturing<=0)Object.values(e.players).forEach((r)=>{if(r.inKotcZone)r.inKotcZone=!1,e.$emit("playerLeaveZone",r,q.RoundEnded)});e.$emit("gameStateChange",{teamScore:{before:n,after:e.game.teamScore},kotc:{before:t,after:e.game.kotc},playersOnZone:{before:i}})}else if(e.game.gameModeId===T.Team){let n=structuredClone(e.game.teamScore);e.game.teamScore[1]=a.unPackInt16U(),e.game.teamScore[2]=a.unPackInt16U(),e.$emit("gameStateChange",{teamScore:{before:n,after:e.game.teamScore}})}if(e.game.gameModeId!==T.Spatula)delete e.game.spatula;if(e.game.gameModeId!==T.KOTC)delete e.game.kotc;if(e.game.gameModeId===T.FFA)delete e.game.teamScore},Pt=Fi;var Ei=(e)=>{let n=a.unPackInt8U(),t=e.players[n];if(t){if(t.playing=!1,t.streakRewards)t.streakRewards=[];if(e.$emit("playerPause",t),t.inKotcZone)t.inKotcZone=!1,e.$emit("playerLeaveZone",t,q.Despawned)}},dt=Ei;var Ai=(e)=>{if(!e.intents.includes(l.PING))return;let n=e.ping;e.ping=Date.now()-e.lastPingTime,e.$emit("pingUpdate",n,e.ping),setTimeout(()=>{let t=new d;t.packInt8(u.ping),t.send(e.game.socket),e.lastPingTime=Date.now()},1000)},It=Ai;var Gi=(e)=>{let n=a.unPackInt8U(),t=a.unPackString(128),i=a.unPackString(32),r=e.players[n];if(!r)return;r.admin={ip:i,dbId:t},e.$emit("playerInfo",r,i,t)},yt=Gi;var $i=(e)=>{let n=a.unPackInt8U(),t=e.players[n];if(!t)return;let i=t.weapons[t.activeGun];if(i.ammo){let r=Math.min(Math.min(i.ammo.capacity,i.ammo.reload)-i.ammo.rounds,i.ammo.store);i.ammo.rounds+=r,i.ammo.store-=r}e.$emit("playerReload",t,i)},wt=$i;var Mi=(e)=>{let n=a.unPackInt8U(),t=structuredClone(e.players[n]);delete e.players[n],e.$emit("playerLeave",t)},xt=Mi;var Li=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt16U(),i=a.unPackFloat(),r=a.unPackFloat(),s=a.unPackFloat(),c=a.unPackInt8U(),o=a.unPackInt8U(),p=a.unPackInt8U(),m=a.unPackInt8U(),f=a.unPackInt8U(),g=e.players[n];if(g){if(g.playing=!0,g.randomSeed=t,g.weapons[0]&&g.weapons[0].ammo)g.weapons[0].ammo.rounds=c;if(g.weapons[0]&&g.weapons[0].ammo)g.weapons[0].ammo.store=o;if(g.weapons[1]&&g.weapons[1].ammo)g.weapons[1].ammo.rounds=p;if(g.weapons[1]&&g.weapons[1].ammo)g.weapons[1].ammo.store=m;g.grenades=f,g.position={x:i,y:r,z:s},g.spawnShield=120,e.$emit("playerRespawn",g)}},St=Li;var Wi=(e)=>{let n=new d;n.packInt8(e.intents.includes(l.OBSERVE_GAME)?u.observeGame:u.joinGame),n.packString(e.game.raw.uuid),n.packInt8(+e.intents.includes(l.VIP_HIDE_BADGE)),n.packInt8(e.state.weaponIdx||e.account?.loadout?.classIdx||0),n.packString(e.state.name),n.packInt32(e.account.session),n.packString(e.account.sessionId),n.packString(e.account.firebaseId),n.send(e.game.socket)},Ut=Wi;var Ki=(e)=>{let n=a.unPackInt16U(),t=a.unPackInt8U(),i=a.unPackFloat(),r=a.unPackFloat(),s=a.unPackFloat();e.game.collectables[t].push({id:n,x:i,y:r,z:s}),e.$emit("spawnItem",t,{x:i,y:r,z:s},n)},vt=Ki;var _i=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=e.players[n];if(!i)return;let r=i.team;i.team=t,i.streak=0,e.$emit("playerSwitchTeam",i,r,t)},Tt=_i;var qi=(e)=>{let n=a.unPackInt8U(),t=e.players[n];a.unPackInt8U();let i=a.unPackInt8U(),r=a.unPackFloat(),s=a.unPackFloat(),c=a.unPackFloat();if(e.me.climbing=!!a.unPackInt8U(),a.unPackInt8U(),a.unPackInt8U(),!t)return;e.state.serverStateIdx=i;let o=t.position.x,p=t.position.y,m=t.position.z;if(t.position.x=r,t.position.y=s,t.position.z=c,o!==r||p!==s||m!==c)e.$emit("playerMove",t,{x:o,y:p,z:m},{x:r,y:s,z:c})},Rt=qi;var Ci=(e)=>{let n=a.unPackInt8U(),t=a.unPackFloat(),i=a.unPackFloat(),r=a.unPackFloat(),s=a.unPackInt8U(),c=e.players[n];if(!c||c.id===e.me.id){for(let U=0;U<C;U++)a.unPackInt8U(),a.unPackRadU(),a.unPackRad(),a.unPackInt8U();return}for(let U=0;U<C;U++){let y=a.unPackInt8U();if(y&O.Jump)c.jumping=!0;else c.jumping=!1;if(y&O.Scope)c.scoping=!0;else c.scoping=!1;let v=structuredClone(c.view);if(c.view.yaw=a.unPackRadU(),c.view.pitch=a.unPackRad(),c.view.yaw!==v.yaw||c.view.pitch!==v.pitch)e.$emit("playerRotate",c,v,c.view);c.scale=a.unPackInt8U()}let o=c.position,p=o.x!==t||o.y!==i||o.z!==r,m=c.climbing!==s,f=p||m,g=f?structuredClone(o):null;if(o.x!==t)o.x=t;if(o.z!==r)o.z=r;if(!c.jumping||Math.abs(o.y-i)>0.5)o.y=i;if(m)c.climbing=s;if(!f)return;if(e.$emit("playerMove",c,g,o),e.game.gameModeId!==T.KOTC)return;let h=e.game.kotc.activeZone,I=!!c.inKotcZone;if(!h&&I){c.inKotcZone=!1,e.$emit("playerLeaveZone",c,q.RoundEnded);return}c.updateKotcZone(h);let S=!!c.inKotcZone;if(I!==S)c.inKotcZone=S,e.$emit(S?"playerEnterZone":"playerLeaveZone",c,S?null:q.WalkedOut)},Ot=Ci;var Zi=(e)=>{let n=a.unPackInt8U(),t=a.unPackFloat(),i=a.unPackFloat(),r=a.unPackFloat(),s=a.unPackFloat(),c=a.unPackFloat(),o=a.unPackFloat(),p=e.players[n];if(p)p.grenades--,e.$emit("playerThrowGrenade",p,{x:t,y:i,z:r},{x:s,y:c,z:o})},Nt=Zi;var Bi=(e)=>{let n=a.unPackInt32U(),t=e.account.eggBalance;e.account.eggBalance=n,e.$emit("balanceUpdate",t,n)},Ft=Bi;var Hi=(e)=>{let n=a.unPackInt8U(),t=a.unPackInt8U(),i=e.players[n];if(i)i.activeGun=t,e.$emit("playerSwapWeapon",i,t)},Et=Hi;var mn=(e,n)=>(e%n+n)%n;class At{static Intents=l;regionList=[];matchmakerListeners=[];#e=[];#n={};#r=[];#t;#a;constructor(e={}){if(e.proxy&&typeof process>"u")throw Error("proxies do not work in this environment");if(this.intents=e.intents||[],this.intents.includes(l.COSMETIC_DATA)){if(!w(1001))throw Error("you cannot use the COSMETIC_DATA intent inside of the browser bundles")}if(this.instance=e.instance||"shellshock.io",this.protocol=e.protocol||"wss",this.proxy=e.proxy||"",this.connectionTimeout=e.connectionTimeout||5000,this.state={name:"yolkbot",weaponIdx:0,useAltGameURL:!1,inGame:!1,chatLines:0,yaw:0,pitch:0,controlKeys:0,onGround:4,dx:0,dy:0,dz:0,reloading:!1,swappingGun:!1,usingMelee:!1,stateIdx:0,serverStateIdx:0,shotsFired:0,buffer:[]},this.players={},this.me=new re({}),this.game={raw:{},code:"",region:"",socket:null,gameModeId:0,gameMode:"ffa",mapIdx:0,map:{filename:"",hash:"",name:"",modes:{FFA:!1,Teams:!1,Spatula:!1,King:!1},availability:"both",numPlayers:"18",raw:{},zones:[]},playerLimit:0,isGameOwner:!1,isPrivate:!0,options:{gravity:1,damage:1,healthRegen:1,locked:!1,noTeamChange:!1,noTeamShuffle:!1,weaponsDisabled:Array(7).fill(!1),mustUseSecondary:!1},collectables:[[],[]],teamScore:[0,0,0],spatula:{coords:{x:0,y:0,z:0},controlledBy:0,controlledByTeam:0},kotc:{stage:b.Capturing,zoneNumber:0,activeZone:[],capturing:0,captureProgress:0,numCapturing:0,capturePercent:0}},this.#a=this.game,this.account={id:0,firebase:{idToken:"",refreshToken:"",expiresIn:"3600",localId:""},firebaseId:"",sessionId:"",session:0,email:"",password:"",cw:{atLimit:!1,limit:0,secondsUntilPlay:0,canPlayAgain:Date.now()},loadout:{hatId:null,meleeId:0,stampId:null,classIdx:0,colorIdx:0,grenadeId:0,primaryId:[3100,3600,3400,3800,4000,4200,4500],secondaryId:[,,,,,,,].fill(3000),stampPositionX:0,stampPositionY:0},ownedItemIds:[],vip:!1,emailVerified:!1,isAged:!1,adminRoles:0,rawLoginData:{},eggBalance:0,isDoubleEggWeeknd:()=>{let n=new Date().getUTCDay();return n>=5&&new Date().getUTCHours()>=20||n===6||n===0}},this.#t=this.account,this.api=new wn({proxy:this.proxy,protocol:this.protocol,instance:this.instance,connectionTimeout:this.connectionTimeout}),this.ping=0,this.lastPingTime=-1,this.lastDeathTime=-1,this.lastUpdateTick=0,this.pathing={nodeList:null,activePath:null,activeNode:null,activeNodeIdx:0},this.hasQuit=!1,this.intents.includes(l.NO_AFK_KICK))this.afkKickInterval=0;if(this.intents.includes(l.RENEW_SESSION))this.renewSessionInterval=0}dispatch(e,n){if(e.validate(this)){if(e.check(this))e.execute(this);else this.#e.push(e);return!0}return console.error(`${n?"emit":"dispatch"}: validation failed for dispatch ${e.constructor.name}`),console.error("this means the dispatch will NEVER RUN!"),console.error("make sure all parameters are valid and that any player IDs are in the game"),!1}async createAccount(e,n){this.account=this.#t,this.account.email=e,this.account.password=n;let t=await this.api.createAccount(e,n);return this.processLoginData(t)}async login(e,n){this.account=this.#t,this.account.email=e,this.account.password=n;let t=await this.api.loginWithCredentials(e,n);return this.processLoginData(t)}async loginWithRefreshToken(e){this.account=this.#t;let n=await this.api.loginWithRefreshToken(e);return this.processLoginData(n)}async loginAnonymously(){this.account=this.#t;let e=await this.api.loginAnonymously();return this.processLoginData(e)}processLoginData(e){if(!e.ok||!e.playerOutput){if(this.$emit("authFail",e),e.ok&&!e.playerOutput)console.error("processLoginData: missing playerOutput but is ok",e);return{...e,error:Fe.InternalError,ok:!1}}if(e.banRemaining)return this.$emit("banned",e.banRemaining),k(Fe.AccountBanned);if(this.account.firebase=e.firebase,e=e.playerOutput,this.account.rawLoginData=e,this.account.adminRoles=e.adminRoles||0,this.account.eggBalance=e.currentBalance,this.account.emailVerified=e.emailVerified,this.account.firebaseId=e.firebaseId,this.account.id=e.id,this.account.isAged=new Date(e.dateCreated).getTime()<1714546800000,this.account.loadout=e.loadout,this.account.ownedItemIds=e.ownedItemIds,this.account.session=e.session,this.account.sessionId=e.sessionId,this.account.vip=e.active_sub==="IsVIP",this.intents.includes(l.BOT_STATS))this.account.stats={lifetime:e.statsLifetime,monthly:e.statsCurrent};if(this.intents.includes(l.CHALLENGES))this.#i(e.challenges);if(this.$emit("authSuccess",this.account),this.intents.includes(l.RENEW_SESSION))this.renewSessionInterval=setInterval(async()=>{if(!this.account?.sessionId)return clearInterval(this.renewSessionInterval);if((await this.api.queryServices({cmd:"renewSession",sessionId:this.account.sessionId})).data!=="renewed")this.$emit("sessionExpired")},600000);return{ok:!0,account:this.account}}#i(e){this.account.challenges=[];for(let n of e){let t=Vn.find((i)=>i.id===n.challengeId);if(!t)continue;delete n.playerId,this.account.challenges.push({raw:{challengeInfo:t,challengeData:n},id:n.challengeId,name:t.loc.title,desc:t.loc.desc,rewardEggs:t.reward,isRerolled:!!n.reset,isClaimed:!!n.claimed,isCompleted:!!n.completed,progressNum:n.progress,goalNum:t.goal})}}async createMatchmaker(){let e=new te(`${this.protocol}://${this.instance}/matchmaker/`,this.proxy);if(e.autoReconnect=!0,!await e.tryConnect())return k(dn.WebSocketConnectFail);this.matchmaker=e;let t=[];return this.matchmaker.onmessage=async(i)=>{let r=JSON.parse(i.data);if(r.command==="validateUUID"){let s=setTimeout(()=>{console.error("createMatchmaker: the matchmaker did not respond to our validateUUID"),console.error("createMatchmaker: this means yolkbot is broken, please report this on Github"),console.error("createMatchmaker: https://github.com/yolkorg/yolkbot (or join the Discord)")},5000);return t.push(s),this.matchmaker.send(JSON.stringify({command:"validateUUID",hash:await Qn(r.uuid)}))}if(r.command==="gameFound"||r.error)t.forEach((s)=>clearTimeout(s));this.matchmakerListeners.forEach((s)=>s(r))},{ok:!0}}async getRegions(){if(!this.matchmaker){let e=await this.createMatchmaker();if(!e.ok)return e}return new Promise((e)=>{let n=(t)=>{if(t.command==="regionList")this.matchmakerListeners.splice(this.matchmakerListeners.indexOf(n),1),this.regionList=t.regionList,e({ok:!0,regionList:this.regionList})};this.matchmakerListeners.push(n),this.matchmaker.send(JSON.stringify({command:"regionList"}))})}async initSession(){if(!this.account.sessionId&&!this.intents.includes(l.SKIP_LOGIN)){let e=await this.loginAnonymously();if(!e.ok)return e}if(!this.matchmaker){let e=await this.createMatchmaker();if(!e.ok)return e}return{ok:!0}}async findPublicGame(e,n){if(typeof e!=="string")return k(A.MissingParams);if(typeof n!=="number")return k(A.MissingParams);if(!(this.regionList.length?this.regionList:cn).find((c)=>c.id===e))return k(A.InvalidRegion);let i;if(typeof n==="number")if(Object.values(T).indexOf(n)>-1)i=n;else return k(A.InvalidMode);else if(typeof n==="string"){let c=Object.keys(T).find((o)=>o.toLowerCase()===n.toLowerCase());if(c)i=T[c];else return k(A.InvalidMode)}else return k(A.InvalidMode);let r=await this.initSession();if(!r.ok)return r;let s=await new Promise((c)=>{let o=(p)=>{if(p.command==="notice")return;if(this.matchmakerListeners.splice(this.matchmakerListeners.indexOf(o),1),p.command==="gameFound"){if(p.useAltGameURL)this.state.useAltGameURL=!0;return c(p)}if(p.error==="sessionNotFound")return c(k(A.SessionExpired));console.error("findPublicGame: unknown matchmaker response",JSON.stringify(p)),c(k(A.InternalError))};this.matchmakerListeners.push(o),this.matchmaker.send(JSON.stringify({command:"findGame",region:e,playType:pe.JoinPublic,gameType:i,sessionId:this.account.sessionId}))});return{ok:!0,region:s.region,subdomain:s.subdomain,id:s.id,private:s.private,raw:s}}async createPrivateGame(e,n,t){if(typeof e!=="string")return k(A.MissingParams);if(!(this.regionList.length?this.regionList:cn).find((p)=>p.id===e))return k(A.InvalidRegion);let r;if(typeof n==="number")if(Object.values(T).indexOf(n)>-1)r=n;else return k(A.InvalidMode);else if(typeof n==="string"){let p=Object.keys(T).find((m)=>m.toLowerCase()===n.toLowerCase());if(p)r=T[p];else return k(A.InvalidMode)}else return k(A.InvalidMode);let s=se.findIndex((p)=>p.name.toLowerCase()===t.toLowerCase());if(s===-1)return k(A.InvalidMap);let c=await this.initSession();if(!c.ok)return c;let o=await new Promise((p)=>{let m=(f)=>{if(f.command==="notice")return;if(this.matchmakerListeners.splice(this.matchmakerListeners.indexOf(m),1),f.command==="gameFound"){if(f.useAltGameURL)this.state.useAltGameURL=!0;return p(f)}if(f.error==="sessionNotFound")return p(k(A.SessionExpired));console.error("createPrivateGame: unknown matchmaker response",JSON.stringify(f)),p(k(A.InternalError))};this.matchmakerListeners.push(m),this.matchmaker.send(JSON.stringify({command:"findGame",region:e,playType:pe.CreatePrivate,gameType:r,sessionId:this.account.sessionId,noobLobby:!1,map:s}))});return{ok:!0,region:o.region,subdomain:o.subdomain,id:o.id,private:o.private,raw:o}}async join(e,n){if(this.state.name=e||"yolkbot",typeof n==="string"){if(n.includes("#"))n=n.split("#")[1];let r=await this.initSession();if(!r.ok)return r;if(await new Promise((c)=>{let o=(p)=>{if(p.command==="gameFound")this.matchmakerListeners.splice(this.matchmakerListeners.indexOf(o),1),this.game.raw=p,this.game.code=p.id,this.game.region=p.region,c(p.id);if(p.error&&p.error==="gameNotFound")this.matchmakerListeners.splice(this.matchmakerListeners.indexOf(o),1),c("gameNotFound")};this.matchmakerListeners.push(o),this.matchmaker.send(JSON.stringify({command:"joinGame",id:n,observe:!1,sessionId:this.account.sessionId}))})==="gameNotFound")return k(D.GameNotFound);if(!this.game.raw.id)return console.error("join: invalid game data received from matchmaker:",this.game.raw),k(D.InternalError)}else if(typeof n==="object"){if(!n.id||!n.subdomain||!n.uuid||!n.region)return k(D.InvalidObject);if(this.account.id===0){let r=await this.loginAnonymously();if(!r.ok)return r}this.game.raw=n,this.game.code=this.game.raw.id,this.game.region=this.game.raw.region}else return k(D.MissingParams);let t=this.state.useAltGameURL?`${this.instance}/servers/${this.game.raw.subdomain}`:`${this.game.raw.subdomain}.${this.instance}`;if(this.game.socket=new te(`${this.protocol}://${t}/game/${this.game.raw.id}`,this.proxy),this.game.socket.binaryType="arraybuffer",this.game.socket.connectionTimeout=this.connectionTimeout,this.game.socket.onBeforeConnect=()=>{this.game.socket.onmessage=(r)=>this.processPacket(r.data),this.game.socket.onclose=(r)=>{if(this.state?.inGame)this.$emit("close",r.code),this.leave(-1)}},!await this.game.socket.tryConnect())return k(D.WebSocketConnectFail);return{ok:!0}}#s(e,n,t){this.state.onGround=Math.max(--this.state.onGround,0),this.me.position.x+=e,this.me.position.y+=n,this.me.position.z+=t;let i=Math.floor(this.me.position.x),r=Math.floor(this.me.position.y),s=Math.floor(this.me.position.z),c=this.pathing.nodeList.at(i,r,s);if(c&&!c.isAir()){if(!this.climbing&&c.isLadder());}if(this.me.climbing);else if(c&&c.isJumpPad())this.me.position.y+=0.26,this.me.jumping=!0,this.state.onGround=0}#c(){let e=this.pathing.activePath.length,n=this.pathing.activePath[e-1],t=this.me.position,i=Math.floor(t.y);if(Math.hypot(t.x-n.flatCenter.x,t.z-n.flatCenter.z)<0.3)this.pathing.activePath=null,this.pathing.activeNode=null,this.pathing.activeNodeIdx=0,this.dispatch(new Q(0)),this.$emit("pathfindComplete");else{let s=!1;if(this.pathing.activeNodeIdx<e-1){let o=this.pathing.activePath[this.pathing.activeNodeIdx],p=this.pathing.activePath[this.pathing.activeNodeIdx+1],m=Math.abs(o.x-p.x),f=Math.abs(o.z-p.z);if(m===2&&f===0||m===0&&f===2||m===2&&f===1||m===1&&f===2||m===2&&f===2){let h=t.x-Math.floor(t.x),I=t.z-Math.floor(t.z),S=p.x>o.x?1:p.x<o.x?-1:0,U=p.z>o.z?1:p.z<o.z?-1:0,y=0;if(S>0)y=1-h;else if(S<0)y=h;else if(U>0)y=1-I;else if(U<0)y=I;if(y<=0.04)s=!0}}if(this.pathing.activeNodeIdx<e){let o=this.pathing.activePath[this.pathing.activeNodeIdx].flatCenter;if(this.state.onGround)this.dispatch(new ae(o))}for(let o=this.pathing.activeNodeIdx;o<e;o++){let p=this.pathing.activePath[o];if(p.flatRadialDistance(t)<0.1&&p.y===i){this.pathing.activeNodeIdx=o+1,this.pathing.activeNode=this.pathing.activePath[this.pathing.activeNodeIdx];break}}let c=O.Forward|(s?O.Jump:0);this.dispatch(new Q(c))}}update(){if(this.hasQuit)return;if(this.pathing.activePath&&this.intents.includes(l.PATHFINDING))this.#c();for(let t=0;t<this.#e.length;t++){let i=this.#e[t];if(i.check(this))i.execute(this),this.#e.splice(t,1)}if(this.state.chatLines=Math.max(0,this.state.chatLines-0.008333333333333333),this.me.playing){let t=this.state.stateIdx,i=this.intents.includes(l.DEBUG_BUFFER);if(i)console.log("setting buffer for idx",t);if(this.me.jumping=!!(this.state.controlKeys&O.Jump),this.state.buffer[t]={controlKeys:this.state.controlKeys,yaw:this.state.yaw,pitch:this.state.pitch,shotsFired:this.state.shotsFired,position:i?{...this.me.position}:{}},this.state.shotsFired=0,this.intents.includes(l.SIMULATION)){let r=0,s=0,c=0,o=this.state.buffer[t];if(o.controlKeys&O.Left)r-=Math.cos(o.yaw),c+=Math.sin(o.yaw);if(o.controlKeys&O.Right)r+=Math.cos(o.yaw),c-=Math.sin(o.yaw);if(o.controlKeys&O.Forward)if(this.me.climbing)s+=1;else r-=Math.sin(o.yaw),c-=Math.cos(o.yaw);if(o.controlKeys&O.Backward)if(this.me.climbing)s-=1;else r+=Math.sin(o.yaw),c+=Math.cos(o.yaw);if(o.controlKeys&O.Jump)this.state.controlKeys^=this.state.controlKeys&O.Jump;if(this.me.climbing)this.me.jumping=!1,s+=s*0.028,this.me.position.y+=s,s*=0.5,this.#s(0,s,0);else{let p=Math.sqrt(r*r+s*s+c*c);if(p>0){let h=r/p,I=c/p;r=this.state.dx+h*0.025,c=this.state.dz+I*0.025}else r=this.state.dx,c=this.state.dz;s=this.state.dy-this.game.options.gravity*0.012,s=Math.max(-0.29,s);let m=this.me.position.x,f=this.me.position.y,g=this.me.position.z;if(this.#s(r,s,c),r=this.me.position.x-m,s=this.me.position.y-f,c=this.me.position.z-g,this.state.onGround&&s>0){let I=1-(p===0?0:s/p)*0.5;r*=I,c*=I}}if(r*=0.64,c*=0.64,this.me.climbing)s*=0.64;this.state.dx=r,this.state.dy=s,this.state.dz=c}if(this.state.stateIdx%C===0){this.$emit("tick");let r=new d;r.packInt8(u.syncMe),r.packInt8(this.state.stateIdx),r.packInt8(this.state.serverStateIdx);let s=mn(this.state.stateIdx-C+1,ee);if(i)console.log("--- START THIS SYNC LOGGING ---");for(let c=0;c<C;c++){let o=mn(s+c,ee),p=this.state.buffer[o]||{},m=p.controlKeys||0,f=p.shotsFired||0,g=p.yaw??this.state.yaw,h=p.pitch??this.state.pitch;if(i)console.log("adding",this.state.stateIdx,s,o,p);r.packInt8(m),r.packInt8(f),r.packString(Xn(g,h)),r.packInt8(100)}if(r.send(this.game.socket),i)console.log("--- END SYNC LOGGING ---");this.state.buffer=[],this.lastUpdateTick=0}else this.lastUpdateTick++;this.state.stateIdx=mn(this.state.stateIdx+1,ee)}if(!this.intents.includes(l.PLAYER_HEALTH))return;let e=0.1*(this.game.isPrivate?this.game.options.healthRegen:1),n=Object.values(this.players);for(let t=0;t<n.length;t++){let i=n[t];if(i.playing&&i.hp>0){let r=i.streakRewards.includes(x.OverHeal);i.hp+=r?-e:e,i.hp=r?Math.max(100,i.hp):Math.min(100,i.hp)}if(i.spawnShield>0)i.spawnShield-=6}}on(e,n){if(Object.keys(this.#n).includes(e))this.#n[e].push(n);else this.#n[e]=[n]}onAny(e){this.#r.push(e)}off(e,n){if(n)this.#n[e]=this.#n[e].filter((t)=>t!==n);else this.#n[e]=[]}$emit(e,...n){if(this.hasQuit)return;if(this.#n[e])for(let t of this.#n[e])t(...n);for(let t of this.#r)t(e,...n)}emit(e,...n){let t=Dn[e];if(t)this.dispatch(new t(...n),!0);else throw Error(`no event found for "${e}"`)}updateGameOptions(){let e=new d;e.packInt8(u.gameOptions),e.packInt8(this.game.options.gravity*4),e.packInt8(this.game.options.damage*4),e.packInt8(this.game.options.healthRegen*4);let n=(this.game.options.locked?1:0)|(this.game.options.noTeamChange?2:0)|(this.game.options.noTeamShuffle?4:0);e.packInt8(n),this.game.options.weaponsDisabled.forEach((t)=>e.packInt8(t?1:0)),e.send(this.game.socket)}packetHandlers={[u.syncThem]:Ot.bind(null,this),[u.fire]:ot.bind(null,this),[u.hitThem]:kt.bind(null,this),[u.syncMe]:Rt.bind(null,this),[u.hitMe]:lt.bind(null,this),[u.swapWeapon]:Et.bind(null,this),[u.collectItem]:it.bind(null,this),[u.respawn]:St.bind(null,this),[u.die]:rt.bind(null,this),[u.pause]:dt.bind(null,this),[u.chat]:tt.bind(null,this),[u.addPlayer]:jn.bind(null,this),[u.removePlayer]:xt.bind(null,this),[u.eventModifier]:st.bind(null,this),[u.metaGameState]:Pt.bind(null,this),[u.beginShellStreak]:bn.bind(null,this),[u.endShellStreak]:at.bind(null,this),[u.hitMeHardBoiled]:ht.bind(null,this),[u.gameOptions]:ft.bind(null,this),[u.ping]:It.bind(null,this),[u.switchTeam]:Tt.bind(null,this),[u.changeCharacter]:nt.bind(null,this),[u.reload]:wt.bind(null,this),[u.explode]:ct.bind(null,this),[u.throwGrenade]:Nt.bind(null,this),[u.spawnItem]:vt.bind(null,this),[u.melee]:gt.bind(null,this),[u.updateBalance]:Ft.bind(null,this),[u.challengeCompleted]:et.bind(null,this),[u.gameAction]:pt.bind(null,this),[u.socketReady]:Ut.bind(null,this),[u.gameJoined]:ut.bind(null,this),[u.playerInfo]:yt.bind(null,this),[u.respawnDenied]:()=>{this.me.playing=!1,this.$emit("respawnDenied")},[u.requestGameOptions]:()=>{this.game.isPrivate=!0,this.updateGameOptions()},[u.expireUpgrade]:()=>{},[u.clientReady]:()=>{},[u.musicInfo]:()=>a.unPackLongString()};processPacket(e){if(a.init(e),this.intents.includes(l.PACKET_HOOK))this.$emit("packet",e);let n=0,t=0;while(a.isMoreDataAvailable()){let i=a.unPackInt8U(),r=this.packetHandlers[i];if(r)r();else{if(console.error(`processPacket: got but couldn't identify: ${Object.keys(u).find((s)=>u[s]===i)} ${i}`),n)console.error(`processPacket: it may be a result of the ${n} command (${t}).`);break}if(n=Object.keys(u).find((s)=>u[s]===i),t=i,this.intents.includes(l.LOG_PACKETS))console.log(`[LOG_PACKETS] packet ${n}: ${t}`)}}async checkChiknWinner(){let e=await this.api.queryServices({cmd:"chicknWinnerReady",id:this.account.id,sessionId:this.account.sessionId});if(!e.ok)return e;return this.account.cw.limit=e.limit,this.account.cw.atLimit=e.limit>=4,this.account.cw.secondsUntilPlay=(this.account.cw.atLimit?e.period:e.span)||0,this.account.cw.canPlayAgain=Date.now()+this.account.cw.secondsUntilPlay*1000,{ok:!0,cw:this.account.cw}}async playChiknWinner(e=!0){if(this.account.cw.atLimit||this.account.cw.limit>Te)return k(K.HitDailyLimit);if(this.account.cw.canPlayAgain>Date.now()&&e)return k(K.OnCooldown);let n=await this.api.queryServices({cmd:"incentivizedVideoReward",firebaseId:this.account.firebaseId,id:this.account.id,sessionId:this.account.sessionId,token:null});if(!n.ok)return n;if(n.error){if(n.error==="RATELIMITED"||n.error==="RATELMITED")return await this.checkChiknWinner(),k(K.OnCooldown);else if(n.error==="SESSION_EXPIRED")return this.$emit("sessionExpired"),k(K.SessionExpired);return console.error("unknown Chikn Winner response, report this on Github:",n),k(K.InternalError)}if(n.reward)return this.account.eggBalance+=n.reward.eggsGiven,n.reward.itemIds.forEach((t)=>this.account.ownedItemIds.push(t)),await this.checkChiknWinner(),{ok:!0,...n.reward};return console.error("unknown Chikn Winner response, report this on Github:",n),k(K.InternalError)}async resetChiknWinner(){if(this.account.eggBalance<200)return k(K.NotEnoughResetEggs);if(!this.account.cw.atLimit)return k(K.NotAtDailyLimit);let e=await this.api.queryServices({cmd:"chwReset",sessionId:this.account.sessionId});if(!e.ok)return e;if(e.result!=="SUCCESS")return console.error("unknown Chikn Winner reset response, report this on Github:",e),k(K.InternalError);return this.account.eggBalance-=200,await this.checkChiknWinner(),{ok:!0,cw:this.account.cw}}canSee(e){if(!this.intents.includes(l.PATHFINDING))throw Error("canSee: you need enable the PATHFINDING intent");return this.pathing.nodeList.hasLineOfSight(this.me.position,e.position)}async refreshChallenges(){let e=await this.api.queryServices({cmd:"challengeGetDaily",sessionId:this.account.sessionId,playerId:this.account.id});if(!e.ok)return e;return this.#i(e),{ok:!0,challenges:this.account.challenges}}async rerollChallenge(e){let n=await this.api.queryServices({cmd:"challengeRerollSlot",sessionId:this.account.sessionId,slotId:e});if(!n.ok)return n;if(n["0"])return this.#i(Object.values(n)),{ok:!0,challenges:this.account.challenges};if(Object.values(Me).includes(n.error))return{ok:!1,error:n.error};return console.error("rerollChallenge: unknown error response",n),{ok:!1,error:Me.InternalError}}async claimChallenge(e){let n=await this.api.queryServices({cmd:"challengeClaimReward",sessionId:this.account.sessionId,slotId:e});if(!n.ok)return n;if(n.reward){if(this.#i(n.challenges),n.reward>0)this.account.eggBalance+=n.reward;return{ok:!0,eggReward:n.reward,updatedChallenges:this.account.challenges}}if(Object.values(Le).includes(n.error))return{ok:!1,error:n.error};return console.error("claimChallenge: unknown error response",n),{ok:!1,error:Le.InternalError}}async refreshBalance(){let e=await this.api.queryServices({cmd:"checkBalance",firebaseId:this.account.firebaseId,sessionId:this.account.sessionId});if(!e.ok)return e;return this.account.eggBalance=e.currentBalance,{ok:!0,currentBalance:e.currentBalance}}async redeemCode(e){let n=await this.api.queryServices({cmd:"redeem",firebaseId:this.account.firebaseId,sessionId:this.account.sessionId,id:this.account.id,code:e});if(!n.ok)return n;if(n.result==="SUCCESS")return this.account.eggBalance=n.eggs_given,n.item_ids.forEach((i)=>this.account.ownedItemIds.push(i)),{ok:!0,eggsGiven:n.eggs_given,itemIds:n.item_ids};if(Object.values(Ae).includes(n.result))return{ok:!1,error:n.result};return console.error("redeemCode: unknown error response",n),{ok:!1,error:Ae.InternalError}}async claimURLReward(e){let n=await this.api.queryServices({cmd:"urlRewardParams",firebaseId:this.account.firebaseId,sessionId:this.account.sessionId,reward:e});if(!n.ok)return n;if(n.result==="SUCCESS")return this.account.eggBalance+=n.eggsGiven,n.itemIds.forEach((i)=>this.account.ownedItemIds.push(i)),{ok:!0,rewards:{eggs:n.eggsGiven,items:n.itemIds}};if(Object.values($e).includes(n.result))return{ok:!1,error:n.result};return console.error("claimURLReward: unknown error response",n),{ok:!1,error:$e.InternalError}}async claimSocialReward(e){let n=await this.api.queryServices({cmd:"reward",firebaseId:this.account.firebaseId,sessionId:this.account.sessionId,rewardTag:e});if(!n.ok)return n;if(n.result==="SUCCESS")return this.account.eggBalance+=n.eggsGiven,n.itemIds.forEach((i)=>this.account.ownedItemIds.push(i)),{ok:!0,rewards:{eggs:n.eggsGiven,items:n.itemIds}};if(Object.values(Ge).includes(n.result))return{ok:!1,error:n.result};return console.error("claimSocialReward: unknown error response",n),{ok:!1,error:Ge.InternalError}}async buyItem(e){let n=await this.api.queryServices({cmd:"buy",firebaseId:this.account.firebaseId,sessionId:this.account.sessionId,itemId:e,save:!0});if(!n.ok)return n;if(n.result==="SUCCESS")return this.account.eggBalance=n.currentBalance,this.account.ownedItemIds.push(n.itemId),{ok:!0,itemId:n.itemId,currentBalance:n.currentBalance};if(Object.values(Ee).includes(n.result))return{ok:!1,error:n.result};return console.error("buyItem: unknown error response",n),{ok:!1,error:Ee.InternalError}}leave(e=xn.mainMenu){if(this.hasQuit)return;if(this.state.inGame=!1,e>-1)this.game?.socket?.close(e),this.$emit("leave",e);clearInterval(this.updateIntervalId),this.#e=[],this.state.chatLines=0,this.state.reloading=!1,this.state.swappingGun=!1,this.state.usingMelee=!1,this.state.stateIdx=0,this.state.serverStateIdx=0,this.state.shotsFired=0,this.state.buffer=[],this.players={},this.me=new re({}),this.game=this.#a,this.ping=0,this.lastPingTime=-1,this.lastDeathTime=-1,this.lastUpdateTick=0,this.pathing={nodeList:null,activePath:null,activeNode:null,activeNodeIdx:0}}logout(){if(this.account=this.#t,this.intents.includes(l.RENEW_SESSION))clearInterval(this.renewSessionInterval)}quit(e=!1){if(this.hasQuit)return;if(this.hasQuit=!0,this.leave(),this.matchmaker){if(this.matchmaker.close(),!e)delete this.matchmaker}if(this.intents.includes(l.NO_AFK_KICK))clearInterval(this.afkKickInterval);if(this.intents.includes(l.RENEW_SESSION))clearInterval(this.renewSessionInterval);if(!e)delete this.account,delete this.api,delete this.game,delete this.me,delete this.pathing,delete this.players,delete this.state,delete this.packetHandlers,this.#t={},this.#a={},this.#n={},this.#r=[],this.#e=[]}}var jo={CommIn:ue,CommOut:me};export{se as Maps,kn as Guns,Ke as GamePlayer,ci as Dispatches,gn as Constants,jo as Comm,At as Bot,We as API};
